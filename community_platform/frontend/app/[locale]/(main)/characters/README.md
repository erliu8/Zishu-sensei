# è§’è‰²é¡µé¢å®ç°æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬ç›®å½•åŒ…å«äº† Zishu ç¤¾åŒºå¹³å°çš„è§’è‰²ç›¸å…³é¡µé¢å®ç°ï¼ŒåŒ…æ‹¬è§’è‰²åˆ—è¡¨ã€è¯¦æƒ…ã€åˆ›å»ºã€ç¼–è¾‘ç­‰åŠŸèƒ½ã€‚

## ğŸ—‚ï¸ æ–‡ä»¶ç»“æ„

```
characters/
â”œâ”€â”€ page.tsx                    # è§’è‰²åˆ—è¡¨é¡µ (/characters)
â”œâ”€â”€ [id]/
â”‚   â”œâ”€â”€ page.tsx               # è§’è‰²è¯¦æƒ…é¡µ (/characters/[id])
â”‚   â””â”€â”€ edit/
â”‚       â””â”€â”€ page.tsx           # ç¼–è¾‘è§’è‰²é¡µ (/characters/[id]/edit)
â”œâ”€â”€ create/
â”‚   â””â”€â”€ page.tsx               # åˆ›å»ºè§’è‰²é¡µ (/characters/create)
â””â”€â”€ README.md                  # æœ¬æ–‡æ¡£
```

å¦å¤–ï¼Œåœ¨ `/profile/characters/page.tsx` ä¸­åŒ…å«äº†"æˆ‘çš„è§’è‰²"é¡µé¢ã€‚

## ğŸ“„ é¡µé¢è¯¦æƒ…

### 1. è§’è‰²åˆ—è¡¨é¡µ (`/characters`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… å±•ç¤ºæ‰€æœ‰å…¬å¼€å‘å¸ƒçš„è§’è‰²
- âœ… ç²¾é€‰è§’è‰²æ¨èï¼ˆæ— ç­›é€‰æ—¶æ˜¾ç¤ºï¼‰
- âœ… çƒ­é—¨è§’è‰²å±•ç¤ºï¼ˆæ— ç­›é€‰æ—¶æ˜¾ç¤ºï¼‰
- âœ… æœç´¢åŠŸèƒ½ï¼ˆæŒ‰åç§°ã€æ ‡ç­¾ï¼‰
- âœ… æ’åºåŠŸèƒ½ï¼ˆæœ€æ–°ã€æœ€å¤šä¸‹è½½ã€è¯„åˆ†æœ€é«˜ç­‰ï¼‰
- âœ… ç½‘æ ¼/åˆ—è¡¨è§†å›¾åˆ‡æ¢
- âœ… åˆ†é¡µæ”¯æŒ
- âœ… å“åº”å¼è®¾è®¡

**ä½¿ç”¨çš„ç»„ä»¶**ï¼š
- `CharacterCard` - è§’è‰²å¡ç‰‡
- `EmptyState` - ç©ºçŠ¶æ€å±•ç¤º
- `LoadingSpinner` - åŠ è½½çŠ¶æ€
- `Pagination` - åˆ†é¡µç»„ä»¶

**ä½¿ç”¨çš„ Hooks**ï¼š
- `useCharacters` - è·å–è§’è‰²åˆ—è¡¨
- `useFeaturedCharacters` - è·å–ç²¾é€‰è§’è‰²
- `useTrendingCharacters` - è·å–çƒ­é—¨è§’è‰²

### 2. è§’è‰²è¯¦æƒ…é¡µ (`/characters/[id]`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… å±•ç¤ºè§’è‰²å®Œæ•´ä¿¡æ¯
- âœ… ç»Ÿè®¡æ•°æ®å±•ç¤ºï¼ˆä¸‹è½½ã€æ”¶è—ã€è¯„åˆ†ç­‰ï¼‰
- âœ… æ‰€æœ‰è€…å¯ç¼–è¾‘/åˆ é™¤/å½’æ¡£
- âœ… è®¿å®¢å¯ä¸‹è½½/å…‹éš†/åˆ†äº«
- âœ… å°é¢å›¾å’Œå¤´åƒå±•ç¤º
- âœ… æ ‡ç­¾å±•ç¤º
- âœ… é€‚é…å™¨ä¿¡æ¯å±•ç¤º
- âœ… åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
- âœ… å½’æ¡£ç¡®è®¤å¯¹è¯æ¡†

**ä½¿ç”¨çš„ç»„ä»¶**ï¼š
- `CharacterDetail` - è§’è‰²è¯¦æƒ…å±•ç¤º
- `Avatar` - å¤´åƒç»„ä»¶
- `Badge` - æ ‡ç­¾å¾½ç« 
- `AlertDialog` - ç¡®è®¤å¯¹è¯æ¡†

**ä½¿ç”¨çš„ Hooks**ï¼š
- `useCharacter` - è·å–è§’è‰²è¯¦æƒ…
- `useDeleteCharacter` - åˆ é™¤è§’è‰²
- `useCloneCharacter` - å…‹éš†è§’è‰²
- `useArchiveCharacter` - å½’æ¡£è§’è‰²
- `useSession` - è·å–ç”¨æˆ·ä¼šè¯

### 3. åˆ›å»ºè§’è‰²é¡µ (`/characters/create`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… å¤šæ­¥éª¤è§’è‰²åˆ›å»ºå‘å¯¼
- âœ… ä¿å­˜è‰ç¨¿åŠŸèƒ½
- âœ… å‘å¸ƒåŠŸèƒ½
- âœ… å–æ¶ˆç¡®è®¤
- âœ… ç™»å½•ä¿æŠ¤ï¼ˆæœªç™»å½•é‡å®šå‘ï¼‰

**ä½¿ç”¨çš„ç»„ä»¶**ï¼š
- `CharacterCreator` - è§’è‰²åˆ›å»ºå‘å¯¼ç»„ä»¶

**ä½¿ç”¨çš„ Hooks**ï¼š
- `useCreateCharacter` - åˆ›å»ºè§’è‰²
- `useSession` - è·å–ç”¨æˆ·ä¼šè¯

### 4. ç¼–è¾‘è§’è‰²é¡µ (`/characters/[id]/edit`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… ç¼–è¾‘ç°æœ‰è§’è‰²
- âœ… å®Œæ•´åº¦æ£€æŸ¥å’Œæç¤º
- âœ… ä¿å­˜è‰ç¨¿
- âœ… å‘å¸ƒ/å–æ¶ˆå‘å¸ƒ
- âœ… é¢„è§ˆåŠŸèƒ½
- âœ… æƒé™æ£€æŸ¥ï¼ˆä»…åˆ›å»ºè€…å¯ç¼–è¾‘ï¼‰
- âœ… å®Œæ•´åº¦ç™¾åˆ†æ¯”æ˜¾ç¤º
- âœ… ç¼ºå¤±é…ç½®é¡¹æç¤º

**ä½¿ç”¨çš„ç»„ä»¶**ï¼š
- `CharacterCreator` - è§’è‰²ç¼–è¾‘å™¨ï¼ˆå¤ç”¨åˆ›å»ºå‘å¯¼ï¼‰
- `Badge` - çŠ¶æ€å¾½ç« 

**ä½¿ç”¨çš„ Hooks**ï¼š
- `useCharacter` - è·å–è§’è‰²è¯¦æƒ…
- `useUpdateCharacter` - æ›´æ–°è§’è‰²
- `usePublishCharacter` - å‘å¸ƒè§’è‰²
- `useUnpublishCharacter` - å–æ¶ˆå‘å¸ƒ
- `useSession` - è·å–ç”¨æˆ·ä¼šè¯

**ç‰¹æ®Šé€»è¾‘**ï¼š
- ä½¿ç”¨ `CharacterModel` ç±»çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼š
  - `isReadyToPublish()` - æ£€æŸ¥æ˜¯å¦å¯ä»¥å‘å¸ƒ
  - `getCompletionPercentage()` - è·å–å®Œæ•´åº¦ç™¾åˆ†æ¯”

### 5. æˆ‘çš„è§’è‰²é¡µ (`/profile/characters`)

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- âœ… å±•ç¤ºç”¨æˆ·è‡ªå·±åˆ›å»ºçš„æ‰€æœ‰è§’è‰²
- âœ… æ ‡ç­¾é¡µåˆ†ç±»ï¼ˆå…¨éƒ¨ã€å·²å‘å¸ƒã€è‰ç¨¿ã€å·²å½’æ¡£ï¼‰
- âœ… æœç´¢åŠŸèƒ½
- âœ… æ’åºåŠŸèƒ½
- âœ… ç½‘æ ¼/åˆ—è¡¨è§†å›¾åˆ‡æ¢
- âœ… ç¼–è¾‘ã€åˆ é™¤ã€å…‹éš†ã€å½’æ¡£æ“ä½œ
- âœ… ç»Ÿè®¡æ•°é‡æ˜¾ç¤º
- âœ… åˆ é™¤å’Œå½’æ¡£ç¡®è®¤å¯¹è¯æ¡†

**ä½¿ç”¨çš„ç»„ä»¶**ï¼š
- `CharacterCard` - è§’è‰²å¡ç‰‡ï¼ˆå¯ç”¨ç¼–è¾‘æ¨¡å¼ï¼‰
- `Tabs` - æ ‡ç­¾é¡µç»„ä»¶
- `AlertDialog` - ç¡®è®¤å¯¹è¯æ¡†

**ä½¿ç”¨çš„ Hooks**ï¼š
- `useMyCharacters` - è·å–æˆ‘çš„è§’è‰²åˆ—è¡¨
- `useDeleteCharacter` - åˆ é™¤è§’è‰²
- `useCloneCharacter` - å…‹éš†è§’è‰²
- `useArchiveCharacter` - å½’æ¡£è§’è‰²
- `useSession` - è·å–ç”¨æˆ·ä¼šè¯

## ğŸ¨ UI/UX è®¾è®¡äº®ç‚¹

### 1. ä¸€è‡´çš„è§†è§‰ä½“éªŒ
- ç»Ÿä¸€çš„å¡ç‰‡æ ·å¼
- ç»Ÿä¸€çš„æŒ‰é’®å’Œæ“ä½œæµç¨‹
- ç»Ÿä¸€çš„åŠ è½½å’Œé”™è¯¯çŠ¶æ€

### 2. å“åº”å¼è®¾è®¡
- ç§»åŠ¨ç«¯ä¼˜åŒ–çš„å¸ƒå±€
- è‡ªé€‚åº”ç½‘æ ¼ç³»ç»Ÿ
- è§¦æ‘¸å‹å¥½çš„äº¤äº’

### 3. æ™ºèƒ½åé¦ˆ
- Toast é€šçŸ¥æç¤º
- ç¡®è®¤å¯¹è¯æ¡†é˜²è¯¯æ“ä½œ
- åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
- ç©ºçŠ¶æ€å¼•å¯¼

### 4. å®Œæ•´åº¦å¼•å¯¼
- ç¼–è¾‘é¡µé¢æ˜¾ç¤ºå®Œæ•´åº¦ç™¾åˆ†æ¯”
- ç¼ºå¤±é…ç½®é¡¹æ¸…æ™°åˆ—å‡º
- é˜»æ­¢ä¸å®Œæ•´è§’è‰²å‘å¸ƒ

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. URL çŠ¶æ€ç®¡ç†
æ‰€æœ‰åˆ—è¡¨é¡µéƒ½ä½¿ç”¨ URL å‚æ•°ç®¡ç†ç­›é€‰å’Œåˆ†é¡µçŠ¶æ€ï¼š
```typescript
const searchParams = useSearchParams();
const router = useRouter();

// è¯»å– URL å‚æ•°
const initialPage = Number(searchParams.get('page')) || 1;
const initialSearch = searchParams.get('search') || '';

// æ›´æ–° URL å‚æ•°
const updateURLParams = (params) => {
  const newParams = new URLSearchParams();
  // ... æ„å»ºå‚æ•°
  router.push(`/characters?${newParams.toString()}`);
};
```

### 2. React Server Components
ä½¿ç”¨ Next.js 14 çš„ `use()` API å¤„ç†å¼‚æ­¥ paramsï¼š
```typescript
const resolvedParams = use(params);
const characterId = resolvedParams.id;
```

### 3. æƒé™æ§åˆ¶
å¤šå±‚æƒé™æ£€æŸ¥ç¡®ä¿å®‰å…¨ï¼š
```typescript
// 1. ç™»å½•æ£€æŸ¥
if (!session) {
  router.push('/login?redirect=/characters/create');
  return null;
}

// 2. æ‰€æœ‰æƒæ£€æŸ¥
const isOwner = session?.user?.id === character?.creatorId;
if (!isOwner) {
  return <EmptyState title="æ— æƒé™" />;
}
```

### 4. ä¹è§‚æ›´æ–°
ä½¿ç”¨ TanStack Query çš„ç¼“å­˜ç®¡ç†å®ç°ä¹è§‚æ›´æ–°ï¼š
```typescript
onSuccess: (newCharacter) => {
  queryClient.setQueryData(
    characterKeys.detail(newCharacter.id),
    newCharacter
  );
  queryClient.invalidateQueries({ 
    queryKey: characterKeys.lists() 
  });
}
```

## ğŸ“¦ ä¾èµ–ç»„ä»¶

### å¿…éœ€çš„ Feature ç»„ä»¶
- `CharacterCard` - è§’è‰²å¡ç‰‡
- `CharacterList` - è§’è‰²åˆ—è¡¨
- `CharacterDetail` - è§’è‰²è¯¦æƒ…
- `CharacterCreator` - è§’è‰²åˆ›å»º/ç¼–è¾‘å‘å¯¼

### å¿…éœ€çš„ Shared ç»„ä»¶
- UI ç»„ä»¶ï¼šButton, Card, Badge, Separator, Tabs, Input, Select
- é€šç”¨ç»„ä»¶ï¼šAvatar, EmptyState, LoadingSpinner, Pagination
- å¯¹è¯æ¡†ï¼šAlertDialog, Sheet

### å¿…éœ€çš„ Hooks
- è§’è‰² Hooksï¼š`use-characters.ts`
- å·¥å…· Hooksï¼š`use-toast`
- Auth Hooksï¼š`useSession` (next-auth)

### å¿…éœ€çš„å·¥å…·å‡½æ•°
- `formatDate` - æ—¥æœŸæ ¼å¼åŒ–
- `formatNumber` - æ•°å­—æ ¼å¼åŒ–
- `cn` - className åˆå¹¶

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### å¯¼èˆªåˆ°è§’è‰²åˆ—è¡¨
```typescript
router.push('/characters');
```

### å¯¼èˆªåˆ°è§’è‰²è¯¦æƒ…
```typescript
router.push(`/characters/${characterId}`);
```

### åˆ›å»ºæ–°è§’è‰²
```typescript
router.push('/characters/create');
```

### ç¼–è¾‘è§’è‰²
```typescript
router.push(`/characters/${characterId}/edit`);
```

### æŸ¥çœ‹æˆ‘çš„è§’è‰²
```typescript
router.push('/profile/characters');
```

## ğŸ§ª æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•
- [ ] CharacterCard æ¸²æŸ“æµ‹è¯•
- [ ] æƒé™æ§åˆ¶é€»è¾‘æµ‹è¯•
- [ ] URL å‚æ•°è§£ææµ‹è¯•
- [ ] è¡¨å•éªŒè¯æµ‹è¯•

### é›†æˆæµ‹è¯•
- [ ] åˆ›å»ºè§’è‰²æµç¨‹æµ‹è¯•
- [ ] ç¼–è¾‘è§’è‰²æµç¨‹æµ‹è¯•
- [ ] åˆ é™¤è§’è‰²æµç¨‹æµ‹è¯•
- [ ] æœç´¢å’Œç­›é€‰æµ‹è¯•

### E2E æµ‹è¯•
- [ ] å®Œæ•´çš„åˆ›å»ºå‘å¸ƒæµç¨‹
- [ ] ç¼–è¾‘å·²å‘å¸ƒè§’è‰²æµç¨‹
- [ ] å½’æ¡£å’Œæ¢å¤æµç¨‹
- [ ] æƒé™æ§åˆ¶éªŒè¯

## ğŸ“ å¾…ä¼˜åŒ–é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**
   - [ ] å®ç°è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§åˆ—è¡¨ï¼‰
   - [ ] å›¾ç‰‡æ‡’åŠ è½½
   - [ ] è·¯ç”±é¢„å–

2. **åŠŸèƒ½å¢å¼º**
   - [ ] æ‰¹é‡æ“ä½œï¼ˆæ‰¹é‡åˆ é™¤ã€æ‰¹é‡å½’æ¡£ï¼‰
   - [ ] é«˜çº§ç­›é€‰ï¼ˆæŒ‰é€‚é…å™¨ç±»å‹ã€è¯„åˆ†èŒƒå›´ç­‰ï¼‰
   - [ ] å¯¼å‡º/å¯¼å…¥è§’è‰²é…ç½®

3. **ç”¨æˆ·ä½“éªŒ**
   - [ ] æ‹–æ‹½æ’åºï¼ˆæˆ‘çš„è§’è‰²é¡µï¼‰
   - [ ] ç¦»çº¿è‰ç¨¿ä¿å­˜
   - [ ] å®æ—¶åä½œç¼–è¾‘

## ğŸ› å·²çŸ¥é—®é¢˜

- æ— 

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®æ–½è®¡åˆ’](../../../docs/IMPLEMENTATION_PLAN.md)
- [é€‚é…å™¨æ¡†æ¶æ–‡æ¡£](../../../../../zishu/adapters/README.md)
- [Character Feature æ–‡æ¡£](../../../src/features/character/README.md)

---

**ç»´æŠ¤è€…**: Zishu Frontend Team  
**æœ€åæ›´æ–°**: 2025-10-23  
**ç‰ˆæœ¬**: 1.0.0


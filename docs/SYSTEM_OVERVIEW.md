# Zishu Sensei ç³»ç»Ÿå…¨æ™¯æ¦‚è§ˆ

## ğŸ“‹ æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£æ—¨åœ¨å¸®åŠ©å¼€å‘è€…å…¨é¢ç†è§£ Zishu Sensei é¡¹ç›®çš„æ•´ä½“æ¶æ„ã€å„æ¨¡å—èŒè´£ä»¥åŠå®ƒä»¬ä¹‹é—´çš„åä½œå…³ç³»ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-31  
**é€‚ç”¨å¯¹è±¡**: æ–°åŠ å…¥çš„å¼€å‘è€…ã€æ¶æ„å¸ˆã€æŠ€æœ¯è´Ÿè´£äºº

---

## ğŸ¯ é¡¹ç›®æ ¸å¿ƒå®šä½

**Zishu Sensei (ç´«èˆ’è€å¸ˆ)** æ˜¯ä¸€ä¸ª**ç°ä»£åŒ–çš„æ¡Œé¢AIåŠ©æ‰‹å¹³å°**ï¼ŒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š

1. **æ¡Œé¢åº”ç”¨** (Desktop App) - ç”¨æˆ·ç«¯AIåŠ©æ‰‹ç¨‹åº
2. **ç¤¾åŒºå¹³å°** (Community Platform) - Webç«¯ç¤¾åŒºå’ŒæœåŠ¡å¹³å°
3. **Pythonæ ¸å¿ƒåº“** (zishu/) - å…±äº«çš„AIèƒ½åŠ›å’Œå·¥å…·åº“

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç”Ÿæ€ç³»ç»Ÿ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   æ¡Œé¢åº”ç”¨ (Tauri)    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   ç¤¾åŒºå¹³å° (Web)      â”‚    â”‚
â”‚  â”‚  - Live2D äº¤äº’        â”‚  ä¸‹è½½   â”‚  - é€‚é…å™¨å¸‚åœº         â”‚    â”‚
â”‚  â”‚  - é€‚é…å™¨ç³»ç»Ÿ         â”‚  åŒæ­¥   â”‚  - æ‰“åŒ…æœåŠ¡           â”‚    â”‚
â”‚  â”‚  - å¤šæ¨¡æ€AI          â”‚  æ›´æ–°   â”‚  - ç”¨æˆ·ç¤¾åŒº           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                  â”‚                â”‚
â”‚             â”‚                                  â”‚                â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                        â”‚                                        â”‚
â”‚                        â–¼                                        â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚             â”‚   Python æ ¸å¿ƒåº“       â”‚                           â”‚
â”‚             â”‚  - LLM é›†æˆ          â”‚                           â”‚
â”‚             â”‚  - é€‚é…å™¨åŸºç±»         â”‚                           â”‚
â”‚             â”‚  - å·¥å…·å‡½æ•°          â”‚                           â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        åŸºç¡€è®¾æ–½å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ PostgreSQL â”‚  â”‚   Redis    â”‚  â”‚   Qdrant   â”‚  â”‚  äº‘æ¨¡å‹  â”‚â”‚
â”‚  â”‚  (ç”¨æˆ·æ•°æ®) â”‚  â”‚  (ç¼“å­˜)    â”‚  â”‚  (å‘é‡åº“)  â”‚  â”‚  (API)   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ–¥ï¸ ä¸€ã€æ¡Œé¢åº”ç”¨ (Desktop App)

### 1.1 æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | è¯´æ˜ |
|------|------|------|
| **UIå±‚** | React 18 + TypeScript | å‰ç«¯ç•Œé¢ |
| **æ¡Œé¢æ¡†æ¶** | Tauri (Rust) | è·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶ |
| **æ ¸å¿ƒé€»è¾‘** | Python 3.9+ | AIèƒ½åŠ›ã€é€‚é…å™¨ç³»ç»Ÿ |
| **æ•°æ®å­˜å‚¨** | SQLite (é€šè¿‡Rust) | æœ¬åœ°æ•°æ®åº“ |
| **Live2D** | Live2D Web SDK | è™šæ‹Ÿè§’è‰²æ˜¾ç¤º |

### 1.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### ğŸ“ ç›®å½•ç»“æ„
```
desktop_app/
â”œâ”€â”€ src/                      # React å‰ç«¯
â”‚   â”œâ”€â”€ components/          # UIç»„ä»¶
â”‚   â”œâ”€â”€ pages/              # é¡µé¢
â”‚   â”œâ”€â”€ services/           # æœåŠ¡å±‚
â”‚   â””â”€â”€ hooks/              # React Hooks
â”‚
â””â”€â”€ src-tauri/              # Rust åç«¯
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ main.rs         # åº”ç”¨å…¥å£
    â”‚   â”œâ”€â”€ commands/       # Tauriå‘½ä»¤
    â”‚   â”‚   â”œâ”€â”€ adapter.rs  # é€‚é…å™¨ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ market.rs   # å¸‚åœºåŠŸèƒ½
    â”‚   â”‚   â”œâ”€â”€ llm.rs      # LLMäº¤äº’
    â”‚   â”‚   â””â”€â”€ system.rs   # ç³»ç»ŸåŠŸèƒ½
    â”‚   â”œâ”€â”€ database/       # SQLiteæ•°æ®åº“
    â”‚   â”‚   â”œâ”€â”€ adapter.rs  # é€‚é…å™¨è¡¨
    â”‚   â”‚   â”œâ”€â”€ character.rs # è§’è‰²è¡¨
    â”‚   â”‚   â”œâ”€â”€ workflow.rs  # å·¥ä½œæµè¡¨
    â”‚   â”‚   â”œâ”€â”€ permission.rs # æƒé™è¡¨
    â”‚   â”‚   â””â”€â”€ performance.rs # æ€§èƒ½è¡¨
    â”‚   â””â”€â”€ state.rs        # å…¨å±€çŠ¶æ€
    â””â”€â”€ Cargo.toml
```

#### ğŸ”Œ é€‚é…å™¨ç³»ç»Ÿ

**é€‚é…å™¨**æ˜¯æ¡Œé¢åº”ç”¨çš„æ ¸å¿ƒæ‰©å±•æœºåˆ¶ï¼Œå…è®¸AIåŠ©æ‰‹æ‰§è¡Œå„ç§ç³»ç»Ÿçº§æ“ä½œã€‚

**é€‚é…å™¨ç”Ÿå‘½å‘¨æœŸ**:
```
å®‰è£… â†’ æƒé™è¯·æ±‚ â†’ ç”¨æˆ·æˆæƒ â†’ æ¿€æ´» â†’ æ‰§è¡Œ â†’ åœç”¨ â†’ å¸è½½
```

**é€‚é…å™¨ç®¡ç†** (`commands/adapter.rs`):
- `list_adapters()` - åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„é€‚é…å™¨
- `install_adapter(path)` - å®‰è£…é€‚é…å™¨ï¼ˆè§£å‹ã€éªŒè¯ã€æ³¨å†Œï¼‰
- `uninstall_adapter(id)` - å¸è½½é€‚é…å™¨
- `enable_adapter(id)` / `disable_adapter(id)` - å¯ç”¨/åœç”¨
- `get_adapter_info(id)` - è·å–é€‚é…å™¨è¯¦ç»†ä¿¡æ¯
- `execute_adapter(id, action, params)` - æ‰§è¡Œé€‚é…å™¨åŠŸèƒ½

**é€‚é…å™¨ç±»å‹**:
```rust
pub enum AdapterCategory {
    FileOperation,      // æ–‡ä»¶æ“ä½œ (è¯»å†™ã€æœç´¢)
    WebAutomation,      // ç½‘é¡µè‡ªåŠ¨åŒ– (æµè§ˆå™¨æ§åˆ¶)
    SystemControl,      // ç³»ç»Ÿæ§åˆ¶ (éŸ³é‡ã€äº®åº¦)
    DataAnalysis,       // æ•°æ®åˆ†æ (Excelã€CSV)
    Communication,      // é€šè®¯ (é‚®ä»¶ã€æ¶ˆæ¯)
    Productivity,       // ç”Ÿäº§åŠ› (æ—¥å†ã€å¾…åŠ)
    Entertainment,      // å¨±ä¹ (éŸ³ä¹ã€è§†é¢‘)
    Development,        // å¼€å‘å·¥å…· (Gitã€ç¼–è¯‘)
    Custom,            // è‡ªå®šä¹‰
}
```

#### ğŸ¤– LLM é›†æˆ (`commands/llm.rs`)

æ¡Œé¢åº”ç”¨é€šè¿‡ä¸¤ç§æ–¹å¼ä½¿ç”¨AIæ¨¡å‹:

**æ–¹å¼1: äº‘ç«¯API** (æ¨è)
```rust
// è°ƒç”¨é…ç½®å¥½çš„äº‘ç«¯æ¨¡å‹ (OpenAI, Qwen, DeepSeekç­‰)
chat(messages, model_config) â†’ Response
```

**æ–¹å¼2: æœ¬åœ°æ¨¡å‹** (å¯é€‰)
```rust
// åŠ è½½æœ¬åœ°æ¨¡å‹æ–‡ä»¶
load_local_model(model_path) â†’ Model
generate(prompt) â†’ Text
```

**é…ç½®æ–‡ä»¶**: `config/services/api_config.yml`
```yaml
providers:
  qwen:
    api_key: ${QWEN_API_KEY}
    base_url: https://dashscope.aliyuncs.com/compatible-mode/v1
    model: qwen-max
    enabled: true
  openai:
    api_key: ${OPENAI_API_KEY}
    base_url: https://api.openai.com/v1
    model: gpt-4-turbo-preview
    enabled: false
```

#### ğŸ” æƒé™ç®¡ç† (`database/permission.rs`)

**æƒé™ç±»å‹** (26ç§):
```rust
pub enum PermissionType {
    // æ–‡ä»¶æƒé™
    FileRead, FileWrite, FileDelete, FileExecute, FileWatch,
    
    // ç½‘ç»œæƒé™
    NetworkHttp, NetworkWebSocket, NetworkSocket, NetworkDns,
    
    // ç³»ç»Ÿæƒé™
    SystemCommand, SystemEnv, SystemInfo, 
    SystemClipboard, SystemNotification,
    
    // åº”ç”¨æƒé™
    AppDatabase, AppConfig, AppChatHistory, 
    AppUserData, AppAdapter,
    
    // ç¡¬ä»¶æƒé™
    HardwareCamera, HardwareMicrophone, 
    HardwareScreenCapture, HardwareLocation,
    
    // é«˜çº§æƒé™
    AdvancedAutoStart, AdvancedBackground, AdvancedAdmin,
    
    // è‡ªå®šä¹‰æƒé™
    Custom(String),
}
```

**æƒé™å·¥ä½œæµ**:
```
1. é€‚é…å™¨è¯·æ±‚æƒé™ â†’ request_permission()
2. ç”¨æˆ·æŸ¥çœ‹è¯·æ±‚ â†’ get_pending_grants()
3. ç”¨æˆ·æˆäºˆ/æ‹’ç» â†’ grant_permission() / deny_permission()
4. æ£€æŸ¥æƒé™ â†’ check_permission()
5. è®°å½•ä½¿ç”¨ â†’ log_permission_usage()
6. æ’¤é”€æƒé™ â†’ revoke_permission()
```

#### ğŸ“Š æ€§èƒ½ç›‘æ§ (`database/performance.rs`)

**ç›‘æ§å†…å®¹**:
- **ç³»ç»Ÿå¿«ç…§**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œä½¿ç”¨ç‡
- **æ€§èƒ½æŒ‡æ ‡**: è‡ªå®šä¹‰æŒ‡æ ‡ï¼ˆå“åº”æ—¶é—´ã€ååé‡ï¼‰
- **ç½‘ç»œæŒ‡æ ‡**: DNSè§£æã€è¿æ¥æ—¶é—´ã€æ•°æ®ä¼ è¾“
- **ç”¨æˆ·æ“ä½œ**: æ“ä½œç±»å‹ã€æŒç»­æ—¶é—´ã€æˆåŠŸç‡
- **æ€§èƒ½è­¦å‘Š**: é˜ˆå€¼è¶…é™å‘Šè­¦

**APIç¤ºä¾‹**:
```rust
// è®°å½•ç³»ç»Ÿå¿«ç…§
record_snapshot(PerformanceSnapshot {
    cpu_usage: 45.2,
    memory_usage: 8192,
    disk_usage: 50.0,
    // ... 17ä¸ªæŒ‡æ ‡
})

// è·å–æ€§èƒ½ç»Ÿè®¡
get_stats(start_time, end_time) â†’ PerformanceStats

// è®°å½•è­¦å‘Š
record_alert(PerformanceAlert {
    metric_name: "memory_usage",
    threshold: 90.0,
    actual_value: 95.0,
    severity: High,
})
```

#### ğŸŒŠ å·¥ä½œæµç³»ç»Ÿ (`database/workflow.rs`)

**å·¥ä½œæµ**å…è®¸ç”¨æˆ·åˆ›å»ºè‡ªåŠ¨åŒ–ä»»åŠ¡åºåˆ—ã€‚

**å·¥ä½œæµçŠ¶æ€**:
```rust
pub enum WorkflowStatus {
    Draft,      // è‰ç¨¿
    Published,  // å·²å‘å¸ƒ
    Archived,   // å·²å½’æ¡£
    Disabled,   // å·²ç¦ç”¨
}
```

**å·¥ä½œæµç»“æ„**:
```json
{
  "id": "workflow_001",
  "name": "æ¯æ—¥è‡ªåŠ¨åŒ–",
  "steps": [
    {
      "id": "step1",
      "type": "adapter",
      "adapter_id": "file_reader",
      "action": "read",
      "params": {"path": "/data/daily.txt"}
    },
    {
      "id": "step2",
      "type": "llm",
      "action": "summarize",
      "params": {"max_length": 200}
    },
    {
      "id": "step3",
      "type": "adapter",
      "adapter_id": "notification",
      "action": "send",
      "params": {"title": "æ¯æ—¥æ‘˜è¦"}
    }
  ],
  "config": {
    "schedule": "0 9 * * *",
    "retry": 3,
    "timeout": 300
  }
}
```

### 1.3 æ•°æ®æµç¤ºä¾‹

**ç”¨æˆ·å¯¹è¯æµç¨‹**:
```
1. ç”¨æˆ·è¾“å…¥ â†’ React UI
2. UIè°ƒç”¨Tauriå‘½ä»¤ â†’ commands/llm.rs
3. Rustè°ƒç”¨Pythonæ ¸å¿ƒåº“ â†’ zishu/llm/
4. Pythonè°ƒç”¨äº‘ç«¯API â†’ OpenAI/Qwen/etc
5. å“åº”è¿”å› â†’ Python â†’ Rust â†’ React
6. æ˜¾ç¤ºç»“æœ + Live2DåŠ¨ç”»
```

**é€‚é…å™¨æ‰§è¡Œæµç¨‹**:
```
1. LLMå†³ç­–éœ€è¦æ‰§è¡ŒæŸæ“ä½œ â†’ è°ƒç”¨é€‚é…å™¨
2. æ£€æŸ¥æƒé™ â†’ database/permission.rs
3. æƒé™é€šè¿‡ â†’ æ‰§è¡Œé€‚é…å™¨ â†’ commands/adapter.rs
4. é€‚é…å™¨è°ƒç”¨Pythonå®ç° â†’ zishu/adapters/
5. æ‰§è¡Œç³»ç»Ÿæ“ä½œ
6. è®°å½•æ—¥å¿— â†’ database/performance.rs
7. è¿”å›ç»“æœç»™LLM
```

---

## ğŸŒ äºŒã€ç¤¾åŒºå¹³å° (Community Platform)

### 2.1 æŠ€æœ¯æ ˆ

#### å‰ç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Next.js | 15 | Reactæ¡†æ¶ (App Router) |
| React | 19 | UIåº“ |
| TypeScript | 5 | ç±»å‹å®‰å…¨ |
| Tailwind CSS | 3 | æ ·å¼ |
| Shadcn/ui | - | ç»„ä»¶åº“ |
| TanStack Query | 5 | æ•°æ®è·å– |
| Zustand | 4 | çŠ¶æ€ç®¡ç† |
| Framer Motion | 11 | åŠ¨ç”» |

#### åç«¯
| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| FastAPI | 0.104+ | Python Webæ¡†æ¶ |
| PostgreSQL | 15 | å…³ç³»æ•°æ®åº“ |
| Redis | 7 | ç¼“å­˜/ä¼šè¯ |
| Qdrant | 1.7+ | å‘é‡æ•°æ®åº“ |
| SQLAlchemy | 2.0 | ORM |
| Celery | 5.3+ | å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— |

### 2.2 å‰ç«¯æ¶æ„

#### ğŸ“ ç›®å½•ç»“æ„ (DDDæ¶æ„)
```
community_platform/frontend/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ page.tsx           # é¦–é¡µ
â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ providers.tsx      # å…¨å±€Provider
â”‚   â””â”€â”€ api/               # API Routes (BFFå±‚)
â”‚       â”œâ”€â”€ auth/          # è®¤è¯API
â”‚       â”œâ”€â”€ adapters/      # é€‚é…å™¨API
â”‚       â””â”€â”€ lib/           # APIå·¥å…·å‡½æ•°
â”‚
â””â”€â”€ src/
    â”œâ”€â”€ features/          # åŠŸèƒ½æ¨¡å— (DDD)
    â”‚   â”œâ”€â”€ auth/         # è®¤è¯æ¨¡å—
    â”‚   â”‚   â”œâ”€â”€ api/      # APIå®¢æˆ·ç«¯
    â”‚   â”‚   â”œâ”€â”€ components/ # UIç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ domain/   # é¢†åŸŸæ¨¡å‹
    â”‚   â”‚   â”œâ”€â”€ hooks/    # React Hooks
    â”‚   â”‚   â”œâ”€â”€ services/ # ä¸šåŠ¡é€»è¾‘
    â”‚   â”‚   â””â”€â”€ store/    # çŠ¶æ€ç®¡ç†
    â”‚   â”‚
    â”‚   â”œâ”€â”€ adapter/      # é€‚é…å™¨å¸‚åœº
    â”‚   â”œâ”€â”€ character/    # è§’è‰²ç®¡ç†
    â”‚   â”œâ”€â”€ community/    # ç¤¾åŒºåŠŸèƒ½
    â”‚   â”œâ”€â”€ packaging/    # æ‰“åŒ…æœåŠ¡
    â”‚   â””â”€â”€ user/         # ç”¨æˆ·ç®¡ç†
    â”‚
    â”œâ”€â”€ shared/           # å…±äº«èµ„æº
    â”‚   â”œâ”€â”€ components/   # é€šç”¨ç»„ä»¶
    â”‚   â”œâ”€â”€ hooks/        # é€šç”¨Hooks
    â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°
    â”‚   â””â”€â”€ types/        # ç±»å‹å®šä¹‰
    â”‚
    â””â”€â”€ infrastructure/   # åŸºç¡€è®¾æ–½
        â”œâ”€â”€ api/          # APIå®¢æˆ·ç«¯åŸºç±»
        â”œâ”€â”€ config/       # é…ç½®
        â””â”€â”€ providers/    # Providerç»„ä»¶
```

#### ğŸ” è®¤è¯ç³»ç»Ÿ (`features/auth/`)

**è®¤è¯æµç¨‹**:
```
1. ç”¨æˆ·ç™»å½• â†’ auth.client.ts â†’ POST /api/auth/login
2. åç«¯éªŒè¯ â†’ è¿”å›JWT token
3. å­˜å‚¨token â†’ token.service.ts (localStorage + cookie)
4. å…¨å±€çŠ¶æ€ â†’ auth.store.ts (Zustand)
5. è‡ªåŠ¨åˆ·æ–° â†’ refreshToken() å®šæ—¶è°ƒç”¨
6. é€€å‡ºç™»å½• â†’ æ¸…ç†tokenå’ŒçŠ¶æ€
```

**Tokenç®¡ç†** (`services/token.service.ts`):
```typescript
class TokenService {
  // å­˜å‚¨token (åŒé‡å­˜å‚¨: localStorage + httpOnly cookie)
  setTokens(accessToken, refreshToken)
  
  // è·å–token
  getAccessToken() â†’ string | null
  getRefreshToken() â†’ string | null
  
  // åˆ·æ–°token
  refreshAccessToken() â†’ Promise<string>
  
  // æ¸…é™¤token
  clearTokens()
  
  // TokenéªŒè¯
  isTokenExpired(token) â†’ boolean
  decodeToken(token) â†’ TokenPayload
}
```

**è®¤è¯å®ˆå«**:
```typescript
// é¡µé¢çº§å®ˆå«
export default function ProtectedPage() {
  const { user, isLoading } = useAuth();
  
  if (isLoading) return <Loading />;
  if (!user) redirect('/login');
  
  return <PageContent />;
}
```

#### ğŸ“¦ é€‚é…å™¨å¸‚åœº (`features/adapter/`)

**æ ¸å¿ƒåŠŸèƒ½**:
1. **æµè§ˆé€‚é…å™¨** - åˆ†ç±»ã€æœç´¢ã€ç­›é€‰
2. **æŸ¥çœ‹è¯¦æƒ…** - è¯¦ç»†ä¿¡æ¯ã€è¯„åˆ†ã€è¯„è®ºã€æˆªå›¾
3. **ä¸‹è½½å®‰è£…** - ä¸‹è½½.zipæ–‡ä»¶ â†’ æ¡Œé¢åº”ç”¨å¯¼å…¥
4. **ä¸Šä¼ é€‚é…å™¨** - å¼€å‘è€…ä¸Šä¼ è‡ªå·±çš„é€‚é…å™¨
5. **è¯„åˆ†è¯„è®º** - ç”¨æˆ·äº’åŠ¨

**æ•°æ®æµ**:
```
1. åˆ—è¡¨é¡µ â†’ useAdapters() â†’ GET /api/adapters
2. è¯¦æƒ…é¡µ â†’ useAdapter(id) â†’ GET /api/adapters/{id}
3. ä¸‹è½½ â†’ downloadAdapter(id) â†’ GET /api/adapters/{id}/download
4. è¯„åˆ† â†’ rateAdapter(id, rating) â†’ POST /api/adapters/{id}/rate
5. è¯„è®º â†’ commentAdapter(id, comment) â†’ POST /api/adapters/{id}/comments
```

#### ğŸ æ‰“åŒ…æœåŠ¡ (`features/packaging/`)

**åŠŸèƒ½**: åœ¨çº¿é…ç½®å¹¶ç”Ÿæˆè‡ªå®šä¹‰æ¡Œé¢åº”ç”¨å®‰è£…åŒ…

**å·¥ä½œæµ**:
```
1. ç”¨æˆ·é…ç½®
   - é€‰æ‹©AIæ¨¡å‹
   - é€‰æ‹©é€‚é…å™¨
   - é€‰æ‹©Live2Dè§’è‰²
   - è‡ªå®šä¹‰è®¾ç½®

2. åç«¯æ‰“åŒ…
   - åˆ›å»ºæ‰“åŒ…ä»»åŠ¡ â†’ POST /api/packaging/create
   - åå°æ‰“åŒ… (Celeryå¼‚æ­¥ä»»åŠ¡)
   - ç”Ÿæˆå®‰è£…åŒ… (.exe/.dmg/.AppImage)

3. ä¸‹è½½å®‰è£…
   - è·å–ä¸‹è½½é“¾æ¥ â†’ GET /api/packaging/{task_id}/download
   - ç”¨æˆ·ä¸‹è½½å®‰è£…åŒ…
   - å®‰è£…åˆ°æœ¬åœ°
```

**æ‰“åŒ…é…ç½®ç¤ºä¾‹**:
```json
{
  "app_name": "æˆ‘çš„AIåŠ©æ‰‹",
  "version": "1.0.0",
  "models": ["qwen-max"],
  "adapters": [
    "file_operation",
    "web_automation",
    "system_control"
  ],
  "character": {
    "live2d_model": "shizuka",
    "voice": "female_cn"
  },
  "settings": {
    "theme": "dark",
    "language": "zh-CN",
    "auto_start": true
  }
}
```

#### ğŸ‘¥ ç¤¾åŒºåŠŸèƒ½ (`features/community/`)

**åŠŸèƒ½æ¨¡å—**:
1. **å¸–å­ç³»ç»Ÿ** - å‘å¸–ã€å›å¤ã€ç‚¹èµ
2. **ç”¨æˆ·å…³æ³¨** - å…³æ³¨ç”¨æˆ·ã€æŸ¥çœ‹åŠ¨æ€
3. **è¯é¢˜æ ‡ç­¾** - æŒ‰è¯é¢˜æµè§ˆå†…å®¹
4. **æœç´¢** - å…¨æ–‡æœç´¢å¸–å­å’Œç”¨æˆ·
5. **é€šçŸ¥** - å®æ—¶æ¶ˆæ¯æ¨é€

### 2.3 åç«¯æ¶æ„

#### ğŸ“ ç›®å½•ç»“æ„
```
community_platform/backend/
â”œâ”€â”€ main.py                # FastAPIåº”ç”¨å…¥å£
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ settings.py       # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ database.py       # æ•°æ®åº“é…ç½®
â”‚
â”œâ”€â”€ api/                  # APIè·¯ç”±
â”‚   â”œâ”€â”€ v1/
â”‚   â”‚   â”œâ”€â”€ auth.py      # è®¤è¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ adapters.py  # é€‚é…å™¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ users.py     # ç”¨æˆ·æ¥å£
â”‚   â”‚   â”œâ”€â”€ posts.py     # å¸–å­æ¥å£
â”‚   â”‚   â””â”€â”€ packaging.py # æ‰“åŒ…æ¥å£
â”‚   â””â”€â”€ dependencies.py   # ä¾èµ–æ³¨å…¥
â”‚
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹ (SQLAlchemy)
â”‚   â”œâ”€â”€ user.py
â”‚   â”œâ”€â”€ adapter.py
â”‚   â”œâ”€â”€ post.py
â”‚   â””â”€â”€ package.py
â”‚
â”œâ”€â”€ schemas/             # Pydantic schemas
â”‚   â”œâ”€â”€ user.py
â”‚   â”œâ”€â”€ adapter.py
â”‚   â””â”€â”€ auth.py
â”‚
â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ auth_service.py
â”‚   â”œâ”€â”€ adapter_service.py
â”‚   â”œâ”€â”€ packaging_service.py
â”‚   â””â”€â”€ notification_service.py
â”‚
â”œâ”€â”€ tasks/               # Celeryå¼‚æ­¥ä»»åŠ¡
â”‚   â”œâ”€â”€ packaging.py     # æ‰“åŒ…ä»»åŠ¡
â”‚   â””â”€â”€ email.py         # é‚®ä»¶å‘é€
â”‚
â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ security.py      # å®‰å…¨å·¥å…·
â”‚   â”œâ”€â”€ cache.py         # ç¼“å­˜å·¥å…·
â”‚   â””â”€â”€ vector.py        # å‘é‡æœç´¢
â”‚
â””â”€â”€ requirements.txt
```

#### ğŸ” è®¤è¯ä¸å®‰å…¨

**JWTè®¤è¯**:
```python
# ç™»å½•
@router.post("/auth/login")
async def login(credentials: LoginRequest):
    user = await authenticate_user(credentials)
    access_token = create_access_token(user.id)
    refresh_token = create_refresh_token(user.id)
    return {
        "access_token": access_token,
        "refresh_token": refresh_token,
        "token_type": "bearer"
    }

# å—ä¿æŠ¤çš„è·¯ç”±
@router.get("/users/me")
async def get_current_user(
    current_user: User = Depends(get_current_user)
):
    return current_user
```

**æƒé™æ§åˆ¶**:
```python
# æƒé™è£…é¥°å™¨
@router.delete("/adapters/{adapter_id}")
async def delete_adapter(
    adapter_id: str,
    current_user: User = Depends(get_current_user),
    _: None = Depends(require_admin)  # éœ€è¦ç®¡ç†å‘˜æƒé™
):
    await adapter_service.delete(adapter_id)
    return {"success": True}
```

#### ğŸ“Š æ•°æ®åº“æ¨¡å‹

**ç”¨æˆ·æ¨¡å‹**:
```python
class User(Base):
    __tablename__ = "users"
    
    id = Column(String, primary_key=True)
    username = Column(String, unique=True, nullable=False)
    email = Column(String, unique=True, nullable=False)
    hashed_password = Column(String, nullable=False)
    role = Column(Enum(UserRole), default=UserRole.USER)
    avatar_url = Column(String)
    bio = Column(Text)
    created_at = Column(DateTime, default=datetime.utcnow)
    
    # å…³ç³»
    adapters = relationship("Adapter", back_populates="author")
    posts = relationship("Post", back_populates="author")
```

**é€‚é…å™¨æ¨¡å‹**:
```python
class Adapter(Base):
    __tablename__ = "adapters"
    
    id = Column(String, primary_key=True)
    name = Column(String, nullable=False)
    display_name = Column(String, nullable=False)
    description = Column(Text)
    category = Column(String, nullable=False)
    version = Column(String, nullable=False)
    author_id = Column(String, ForeignKey("users.id"))
    
    # ç»Ÿè®¡æ•°æ®
    downloads = Column(Integer, default=0)
    rating = Column(Float, default=0.0)
    rating_count = Column(Integer, default=0)
    
    # æ–‡ä»¶ä¿¡æ¯
    file_url = Column(String, nullable=False)
    file_size = Column(BigInteger)
    file_hash = Column(String)
    
    # å…ƒæ•°æ®
    tags = Column(JSON)
    dependencies = Column(JSON)
    requirements = Column(JSON)
    
    # å…³ç³»
    author = relationship("User", back_populates="adapters")
    comments = relationship("AdapterComment")
```

#### ğŸ” æœç´¢ä¸æ¨è

**å‘é‡æœç´¢** (Qdrant):
```python
class VectorSearchService:
    def __init__(self, qdrant_client):
        self.client = qdrant_client
        self.collection = "adapters"
    
    async def search_adapters(
        self, 
        query: str, 
        limit: int = 10
    ) -> List[Adapter]:
        # 1. å°†æŸ¥è¯¢è½¬æ¢ä¸ºå‘é‡
        query_vector = await self.embed_text(query)
        
        # 2. å‘é‡æœç´¢
        results = self.client.search(
            collection_name=self.collection,
            query_vector=query_vector,
            limit=limit
        )
        
        # 3. è·å–å®Œæ•´æ•°æ®
        adapter_ids = [r.id for r in results]
        adapters = await get_adapters_by_ids(adapter_ids)
        
        return adapters
    
    async def recommend_adapters(
        self, 
        user_id: str, 
        limit: int = 5
    ) -> List[Adapter]:
        # åŸºäºç”¨æˆ·å†å²æ¨è
        user_history = await get_user_adapter_history(user_id)
        # ... æ¨èç®—æ³•
        return recommended_adapters
```

#### âš¡ ç¼“å­˜ç­–ç•¥

**Redisç¼“å­˜**:
```python
class CacheService:
    def __init__(self, redis_client):
        self.redis = redis_client
    
    async def get_adapter(self, adapter_id: str):
        # 1. å°è¯•ä»ç¼“å­˜è·å–
        cached = await self.redis.get(f"adapter:{adapter_id}")
        if cached:
            return json.loads(cached)
        
        # 2. ä»æ•°æ®åº“è·å–
        adapter = await db.get_adapter(adapter_id)
        
        # 3. å†™å…¥ç¼“å­˜ (TTL: 1å°æ—¶)
        await self.redis.setex(
            f"adapter:{adapter_id}",
            3600,
            json.dumps(adapter.dict())
        )
        
        return adapter
```

#### ğŸ“¦ æ‰“åŒ…æœåŠ¡

**Celeryå¼‚æ­¥ä»»åŠ¡**:
```python
@celery_app.task
def create_package_task(package_config: dict):
    """
    å¼‚æ­¥æ‰“åŒ…ä»»åŠ¡
    """
    task_id = package_config["task_id"]
    
    try:
        # 1. æ›´æ–°çŠ¶æ€: æ‰“åŒ…ä¸­
        update_package_status(task_id, "packaging")
        
        # 2. å‡†å¤‡åŸºç¡€åº”ç”¨
        base_app = download_base_app(package_config["platform"])
        
        # 3. æ³¨å…¥é…ç½®
        inject_config(base_app, package_config)
        
        # 4. æ‰“åŒ…é€‚é…å™¨
        for adapter_id in package_config["adapters"]:
            adapter = download_adapter(adapter_id)
            install_adapter(base_app, adapter)
        
        # 5. æ·»åŠ è§’è‰²èµ„æº
        character = download_character(package_config["character"])
        install_character(base_app, character)
        
        # 6. æ„å»ºå®‰è£…åŒ…
        installer = build_installer(base_app, package_config)
        
        # 7. ä¸Šä¼ åˆ°å­˜å‚¨
        download_url = upload_to_storage(installer)
        
        # 8. æ›´æ–°çŠ¶æ€: å®Œæˆ
        update_package_status(task_id, "completed", {
            "download_url": download_url,
            "file_size": os.path.getsize(installer)
        })
        
    except Exception as e:
        # æ‰“åŒ…å¤±è´¥
        update_package_status(task_id, "failed", {
            "error": str(e)
        })
        raise
```

---

## ğŸ ä¸‰ã€Python æ ¸å¿ƒåº“ (zishu/)

### 3.1 ç›®å½•ç»“æ„

```
zishu/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ adapters/              # é€‚é…å™¨ç³»ç»Ÿ
â”‚   â”œâ”€â”€ base.py           # é€‚é…å™¨åŸºç±»
â”‚   â”œâ”€â”€ file_ops.py       # æ–‡ä»¶æ“ä½œé€‚é…å™¨
â”‚   â”œâ”€â”€ web_automation.py # ç½‘é¡µè‡ªåŠ¨åŒ–
â”‚   â””â”€â”€ system_control.py # ç³»ç»Ÿæ§åˆ¶
â”‚
â”œâ”€â”€ llm/                   # LLMé›†æˆ
â”‚   â”œâ”€â”€ base.py           # LLMåŸºç±»
â”‚   â”œâ”€â”€ openai_client.py  # OpenAIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ qwen_client.py    # Qwenå®¢æˆ·ç«¯
â”‚   â””â”€â”€ local_model.py    # æœ¬åœ°æ¨¡å‹
â”‚
â”œâ”€â”€ live2d/               # Live2Dé›†æˆ
â”‚   â”œâ”€â”€ manager.py        # Live2Dç®¡ç†å™¨
â”‚   â””â”€â”€ models/           # Live2Dæ¨¡å‹èµ„æº
â”‚
â”œâ”€â”€ training/             # æ¨¡å‹è®­ç»ƒ
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â””â”€â”€ base.py       # ModelManagerç±»
â”‚   â””â”€â”€ dataset/
â”‚
â”œâ”€â”€ api/                  # APIå®¢æˆ·ç«¯
â”‚   â””â”€â”€ community.py      # ç¤¾åŒºå¹³å°APIå®¢æˆ·ç«¯
â”‚
â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
    â”œâ”€â”€ logger.py         # æ—¥å¿—å·¥å…·
    â”œâ”€â”€ config.py         # é…ç½®åŠ è½½
    â””â”€â”€ security.py       # å®‰å…¨å·¥å…·
```

### 3.2 é€‚é…å™¨åŸºç±»

```python
# zishu/adapters/base.py
class BaseAdapter(ABC):
    """é€‚é…å™¨åŸºç±»"""
    
    def __init__(self, config: dict):
        self.config = config
        self.name = config["name"]
        self.version = config["version"]
        self.category = config["category"]
    
    @abstractmethod
    async def execute(self, action: str, params: dict) -> dict:
        """
        æ‰§è¡Œé€‚é…å™¨æ“ä½œ
        
        Args:
            action: æ“ä½œåç§°
            params: æ“ä½œå‚æ•°
        
        Returns:
            æ“ä½œç»“æœ
        """
        pass
    
    @abstractmethod
    def get_required_permissions(self) -> List[str]:
        """è·å–éœ€è¦çš„æƒé™åˆ—è¡¨"""
        pass
    
    def validate_params(self, action: str, params: dict) -> bool:
        """éªŒè¯å‚æ•°"""
        schema = self.get_action_schema(action)
        # ä½¿ç”¨ jsonschema éªŒè¯
        return validate(params, schema)
```

**é€‚é…å™¨ç¤ºä¾‹**:
```python
# zishu/adapters/file_ops.py
class FileOperationAdapter(BaseAdapter):
    """æ–‡ä»¶æ“ä½œé€‚é…å™¨"""
    
    def get_required_permissions(self):
        return [
            "FileRead",
            "FileWrite",
            "FileDelete"
        ]
    
    async def execute(self, action: str, params: dict):
        if action == "read":
            return await self.read_file(params["path"])
        elif action == "write":
            return await self.write_file(
                params["path"], 
                params["content"]
            )
        elif action == "delete":
            return await self.delete_file(params["path"])
        else:
            raise ValueError(f"Unknown action: {action}")
    
    async def read_file(self, path: str) -> dict:
        with open(path, 'r', encoding='utf-8') as f:
            content = f.read()
        return {
            "success": True,
            "content": content,
            "size": len(content)
        }
```

### 3.3 LLMé›†æˆ

```python
# zishu/llm/base.py
class BaseLLMClient(ABC):
    """LLMå®¢æˆ·ç«¯åŸºç±»"""
    
    @abstractmethod
    async def chat(
        self, 
        messages: List[dict],
        temperature: float = 0.7,
        max_tokens: int = 2000
    ) -> str:
        """èŠå¤©æ¥å£"""
        pass
    
    @abstractmethod
    async def stream_chat(
        self, 
        messages: List[dict]
    ) -> AsyncIterator[str]:
        """æµå¼èŠå¤©"""
        pass


# zishu/llm/qwen_client.py
class QwenClient(BaseLLMClient):
    """é€šä¹‰åƒé—®å®¢æˆ·ç«¯"""
    
    def __init__(self, api_key: str, model: str = "qwen-max"):
        self.api_key = api_key
        self.model = model
        self.base_url = "https://dashscope.aliyuncs.com/compatible-mode/v1"
    
    async def chat(self, messages, temperature=0.7, max_tokens=2000):
        headers = {
            "Authorization": f"Bearer {self.api_key}",
            "Content-Type": "application/json"
        }
        
        data = {
            "model": self.model,
            "messages": messages,
            "temperature": temperature,
            "max_tokens": max_tokens
        }
        
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{self.base_url}/chat/completions",
                headers=headers,
                json=data
            )
            result = response.json()
            return result["choices"][0]["message"]["content"]
```

### 3.4 æ¨¡å‹è®­ç»ƒ (å¯é€‰)

```python
# zishu/training/train/base.py
class ModelManager:
    """åŸºç¡€æ¨¡å‹ç®¡ç†ç±»"""
    
    def __init__(self, config_path: str):
        self.config = self.load_config(config_path)
        self.device = "cuda" if torch.cuda.is_available() else "cpu"
        self._model = None
        self._tokenizer = None
    
    def load_model(self):
        """åŠ è½½æ¨¡å‹"""
        model_path = self.config["model_path"]
        self._model = AutoModelForCausalLM.from_pretrained(
            model_path,
            torch_dtype=torch.float16,
            device_map="auto"
        )
        return self._model
    
    def load_tokenizer(self):
        """åŠ è½½åˆ†è¯å™¨"""
        tokenizer_path = self.config["tokenizer_path"]
        self._tokenizer = AutoTokenizer.from_pretrained(tokenizer_path)
        return self._tokenizer
    
    def generate(
        self, 
        prompt: str, 
        max_new_tokens: int = 256
    ) -> str:
        """ç”Ÿæˆæ–‡æœ¬"""
        inputs = self._tokenizer(prompt, return_tensors="pt").to(self.device)
        
        with torch.no_grad():
            outputs = self._model.generate(
                inputs.input_ids,
                max_new_tokens=max_new_tokens,
                temperature=0.7,
                top_p=0.9
            )
        
        generated_text = self._tokenizer.decode(
            outputs[0], 
            skip_special_tokens=True
        )
        return generated_text[len(prompt):].strip()
```

---

## ğŸ”„ å››ã€ç³»ç»Ÿé›†æˆä¸æ•°æ®æµ

### 4.1 æ¡Œé¢åº”ç”¨ä¸ç¤¾åŒºå¹³å°é›†æˆ

#### åœºæ™¯1: ç”¨æˆ·ä¸‹è½½å®‰è£…é€‚é…å™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¡Œé¢åº”ç”¨ â”‚         â”‚ ç¤¾åŒºå¹³å° â”‚         â”‚ æ•°æ®åº“   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                   â”‚                   â”‚
     â”‚ 1. æµè§ˆé€‚é…å™¨      â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚                   â”‚ 2. æŸ¥è¯¢é€‚é…å™¨åˆ—è¡¨  â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 3. è¿”å›åˆ—è¡¨        â”‚
     â”‚                   â”‚                   â”‚
     â”‚ 4. ä¸‹è½½é€‚é…å™¨      â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚                   â”‚ 5. è·å–æ–‡ä»¶        â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 6. è¿”å›.zipæ–‡ä»¶    â”‚
     â”‚                   â”‚                   â”‚
     â”‚ 7. å®‰è£…é€‚é…å™¨      â”‚                   â”‚
     â”‚ (æœ¬åœ°æ•°æ®åº“)        â”‚                   â”‚
     â”‚                   â”‚                   â”‚
     â”‚ 8. åŒæ­¥å®‰è£…è®°å½•     â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚                   â”‚ 9. æ›´æ–°ä¸‹è½½ç»Ÿè®¡    â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                   â”‚                   â”‚
```

#### åœºæ™¯2: åœ¨çº¿æ‰“åŒ…å®šåˆ¶åº”ç”¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æµè§ˆå™¨â”‚         â”‚ ç¤¾åŒºå¹³å° â”‚         â”‚ æ‰“åŒ…æœåŠ¡ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                   â”‚                   â”‚
     â”‚ 1. è®¿é—®æ‰“åŒ…é¡µé¢    â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚                   â”‚                   â”‚
     â”‚ 2. é…ç½®åº”ç”¨        â”‚                   â”‚
     â”‚ (é€‰æ‹©æ¨¡å‹/é€‚é…å™¨)   â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚                   â”‚                   â”‚
     â”‚                   â”‚ 3. åˆ›å»ºæ‰“åŒ…ä»»åŠ¡    â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 4. è¿”å›task_id    â”‚
     â”‚                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                   â”‚                   â”‚
     â”‚ 5. è½®è¯¢ä»»åŠ¡çŠ¶æ€    â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ status: packaging â”‚
     â”‚                   â”‚                   â”‚
     â”‚ ... (ç­‰å¾…) ...    â”‚                   â”‚
     â”‚                   â”‚                   â”‚ (åå°æ‰“åŒ…ä¸­)
     â”‚ 6. è½®è¯¢ä»»åŠ¡çŠ¶æ€    â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ status: completed â”‚
     â”‚                   â”‚                   â”‚
     â”‚ 7. ä¸‹è½½å®‰è£…åŒ…      â”‚                   â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                   â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ installer.exe     â”‚
     â”‚                   â”‚                   â”‚
```

### 4.2 AIå¯¹è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥ â”‚   â”‚ æ¡Œé¢åº”ç”¨  â”‚   â”‚ Pythonæ ¸å¿ƒâ”‚   â”‚ äº‘ç«¯API  â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚             â”‚              â”‚              â”‚
      â”‚ "å¸®æˆ‘æ€»ç»“è¿™ä¸ªâ”‚              â”‚              â”‚
      â”‚  æ–‡ä»¶"       â”‚              â”‚              â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚              â”‚
      â”‚             â”‚ 1. è§£ææ„å›¾   â”‚              â”‚
      â”‚             â”‚ (éœ€è¦æ–‡ä»¶æ“ä½œ) â”‚              â”‚
      â”‚             â”‚              â”‚              â”‚
      â”‚             â”‚ 2. æ£€æŸ¥æƒé™   â”‚              â”‚
      â”‚             â”‚ (FileRead)   â”‚              â”‚
      â”‚             â”‚              â”‚              â”‚
      â”‚             â”‚ 3. æ‰§è¡Œé€‚é…å™¨ â”‚              â”‚
      â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
      â”‚             â”‚              â”‚ file_ops.readâ”‚
      â”‚             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
      â”‚             â”‚ æ–‡ä»¶å†…å®¹      â”‚              â”‚
      â”‚             â”‚              â”‚              â”‚
      â”‚             â”‚ 4. è°ƒç”¨LLM    â”‚              â”‚
      â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
      â”‚             â”‚              â”‚ 5. APIè°ƒç”¨   â”‚
      â”‚             â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
      â”‚             â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚             â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 6. AIå“åº”    â”‚
      â”‚             â”‚ æ‘˜è¦å†…å®¹      â”‚              â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚              â”‚
      â”‚ æ˜¾ç¤ºæ‘˜è¦     â”‚              â”‚              â”‚
      â”‚             â”‚              â”‚              â”‚
```

### 4.3 æƒé™è¯·æ±‚æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‚é…å™¨   â”‚   â”‚ æ¡Œé¢åº”ç”¨  â”‚   â”‚  ç”¨æˆ·    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚
     â”‚ 1. è¯·æ±‚æƒé™   â”‚              â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚
     â”‚ FileWrite    â”‚              â”‚
     â”‚              â”‚              â”‚
     â”‚              â”‚ 2. æ˜¾ç¤ºæƒé™å¯¹è¯â”‚
     â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚              â”‚ "XXé€‚é…å™¨è¯·æ±‚  â”‚
     â”‚              â”‚  å†™å…¥æ–‡ä»¶æƒé™" â”‚
     â”‚              â”‚              â”‚
     â”‚              â”‚ 3. ç”¨æˆ·å†³ç­–   â”‚
     â”‚              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚              â”‚ [å…è®¸]       â”‚
     â”‚              â”‚              â”‚
     â”‚              â”‚ 4. ä¿å­˜æˆæƒ   â”‚
     â”‚              â”‚ (permissionè¡¨)â”‚
     â”‚              â”‚              â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 5. è¿”å›ç»“æœ   â”‚
     â”‚ granted      â”‚              â”‚
     â”‚              â”‚              â”‚
     â”‚ 6. æ‰§è¡Œæ“ä½œ   â”‚              â”‚
     â”‚              â”‚              â”‚
```

---

## ğŸš€ äº”ã€éƒ¨ç½²æ¶æ„

### 5.1 å¼€å‘ç¯å¢ƒ

```
æœ¬åœ°æœºå™¨
â”œâ”€â”€ æ¡Œé¢åº”ç”¨ (localhost:1420)
â”‚   â””â”€â”€ npm run tauri:dev
â”‚
â”œâ”€â”€ ç¤¾åŒºå¹³å°å‰ç«¯ (localhost:3000)
â”‚   â””â”€â”€ npm run dev
â”‚
â””â”€â”€ ç¤¾åŒºå¹³å°åç«¯ (localhost:8000)
    â””â”€â”€ uvicorn main:app --reload
```

### 5.2 ç”Ÿäº§ç¯å¢ƒ (Docker)

```yaml
# docker-compose.yml
version: '3.8'

services:
  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/conf.d:/etc/nginx/conf.d
      - ./nginx/ssl:/etc/nginx/ssl
  
  # Next.jså‰ç«¯
  frontend:
    build: ./community_platform/frontend
    environment:
      - NODE_ENV=production
  
  # FastAPIåç«¯
  backend:
    build: ./community_platform/backend
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres:5432/zishu
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - postgres
      - redis
  
  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_DB=zishu
      - POSTGRES_USER=zishu
      - POSTGRES_PASSWORD=secret
  
  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    command: redis-server --requirepass secret
  
  # Qdrantå‘é‡æ•°æ®åº“
  qdrant:
    image: qdrant/qdrant:v1.7.0
    volumes:
      - qdrant_data:/qdrant/storage
  
  # Celeryä»»åŠ¡é˜Ÿåˆ—
  celery:
    build: ./community_platform/backend
    command: celery -A tasks worker -l info
    depends_on:
      - redis
      - backend

volumes:
  postgres_data:
  qdrant_data:
```

### 5.3 äº‘æœåŠ¡å™¨éƒ¨ç½²

**æ¨èé…ç½®**:
```
æœåŠ¡å™¨: 4æ ¸8G (æœ€ä½2æ ¸4G)
å­˜å‚¨: 100GB SSD + 200GB äº‘ç¡¬ç›˜
ç³»ç»Ÿ: Ubuntu 22.04 LTS
Docker: 24.0+
```

**ç›®å½•ç»“æ„**:
```
/data/disk/zishu-sensei/          # äº‘ç¡¬ç›˜æŒ‚è½½ç‚¹
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ postgres/                 # PostgreSQLæ•°æ®
â”‚   â”œâ”€â”€ redis/                    # Redisæ•°æ®
â”‚   â”œâ”€â”€ qdrant/                   # Qdrantæ•°æ®
â”‚   â””â”€â”€ prometheus/               # ç›‘æ§æ•°æ®
â”œâ”€â”€ models/                       # AIæ¨¡å‹æ–‡ä»¶ (å¯é€‰)
â”œâ”€â”€ logs/                         # åº”ç”¨æ—¥å¿—
â””â”€â”€ backup/                       # æ•°æ®å¤‡ä»½
```

**éƒ¨ç½²å‘½ä»¤**:
```bash
# 1. å…‹éš†ä»£ç 
git clone https://github.com/yourusername/zishu-sensei.git
cd zishu-sensei

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env

# 3. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 5. è®¿é—®æœåŠ¡
# å‰ç«¯: https://your-domain.com
# API: https://your-domain.com/api
# æ–‡æ¡£: https://your-domain.com/api/docs
```

---

## ğŸ“Š å…­ã€æ•°æ®åº“è®¾è®¡

### 6.1 æ¡Œé¢åº”ç”¨æœ¬åœ°æ•°æ®åº“ (SQLite)

**æ ¸å¿ƒè¡¨**:
```sql
-- é€‚é…å™¨è¡¨
CREATE TABLE adapters (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    version TEXT NOT NULL,
    category TEXT NOT NULL,
    status TEXT NOT NULL,
    config JSONB,
    installed_at BIGINT NOT NULL,
    updated_at BIGINT NOT NULL
);

-- è§’è‰²è¡¨
CREATE TABLE characters (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    model_path TEXT NOT NULL,
    voice_id TEXT,
    config JSONB,
    is_active BOOLEAN DEFAULT false,
    created_at BIGINT NOT NULL
);

-- å·¥ä½œæµè¡¨
CREATE TABLE workflows (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    description TEXT,
    version TEXT NOT NULL,
    status TEXT NOT NULL,
    steps JSONB,
    config JSONB,
    created_at BIGINT NOT NULL,
    updated_at BIGINT NOT NULL
);

-- æƒé™æˆäºˆè¡¨
CREATE TABLE permission_grants (
    id TEXT PRIMARY KEY,
    entity_type TEXT NOT NULL,
    entity_id TEXT NOT NULL,
    permission_type TEXT NOT NULL,
    permission_level TEXT NOT NULL,
    status TEXT NOT NULL,
    expires_at BIGINT,
    granted_at BIGINT NOT NULL
);

-- æ€§èƒ½å¿«ç…§è¡¨
CREATE TABLE performance_snapshots (
    id TEXT PRIMARY KEY,
    timestamp BIGINT NOT NULL,
    cpu_usage REAL NOT NULL,
    memory_usage BIGINT NOT NULL,
    disk_usage REAL NOT NULL,
    network_sent BIGINT NOT NULL,
    network_received BIGINT NOT NULL
    -- ... å…±17ä¸ªæŒ‡æ ‡
);
```

### 6.2 ç¤¾åŒºå¹³å°æ•°æ®åº“ (PostgreSQL)

**æ ¸å¿ƒè¡¨**:
```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    id VARCHAR(50) PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    hashed_password VARCHAR(255) NOT NULL,
    role VARCHAR(20) NOT NULL DEFAULT 'user',
    avatar_url TEXT,
    bio TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- é€‚é…å™¨è¡¨
CREATE TABLE adapters (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    display_name VARCHAR(100) NOT NULL,
    description TEXT,
    category VARCHAR(50) NOT NULL,
    version VARCHAR(20) NOT NULL,
    author_id VARCHAR(50) REFERENCES users(id),
    
    -- ç»Ÿè®¡
    downloads INTEGER DEFAULT 0,
    views INTEGER DEFAULT 0,
    rating DECIMAL(3,2) DEFAULT 0,
    rating_count INTEGER DEFAULT 0,
    
    -- æ–‡ä»¶
    file_url TEXT NOT NULL,
    file_size BIGINT,
    file_hash VARCHAR(64),
    
    -- å…ƒæ•°æ®
    tags JSONB,
    dependencies JSONB,
    requirements JSONB,
    
    -- çŠ¶æ€
    status VARCHAR(20) DEFAULT 'published',
    is_featured BOOLEAN DEFAULT false,
    is_verified BOOLEAN DEFAULT false,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- å¸–å­è¡¨
CREATE TABLE posts (
    id VARCHAR(50) PRIMARY KEY,
    author_id VARCHAR(50) REFERENCES users(id),
    title VARCHAR(200) NOT NULL,
    content TEXT NOT NULL,
    category VARCHAR(50),
    tags JSONB,
    
    -- ç»Ÿè®¡
    views INTEGER DEFAULT 0,
    likes INTEGER DEFAULT 0,
    comments_count INTEGER DEFAULT 0,
    
    -- çŠ¶æ€
    status VARCHAR(20) DEFAULT 'published',
    is_pinned BOOLEAN DEFAULT false,
    
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- è¯„è®ºè¡¨
CREATE TABLE comments (
    id VARCHAR(50) PRIMARY KEY,
    post_id VARCHAR(50) REFERENCES posts(id) ON DELETE CASCADE,
    author_id VARCHAR(50) REFERENCES users(id),
    parent_id VARCHAR(50) REFERENCES comments(id),
    content TEXT NOT NULL,
    likes INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);

-- æ‰“åŒ…ä»»åŠ¡è¡¨
CREATE TABLE packaging_tasks (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) REFERENCES users(id),
    config JSONB NOT NULL,
    status VARCHAR(20) NOT NULL,
    platform VARCHAR(20) NOT NULL,
    
    -- ç»“æœ
    download_url TEXT,
    file_size BIGINT,
    error_message TEXT,
    
    created_at TIMESTAMP DEFAULT NOW(),
    completed_at TIMESTAMP
);
```

---

## ğŸ”§ ä¸ƒã€é…ç½®ç®¡ç†

### 7.1 ç¯å¢ƒå˜é‡

**æ¡Œé¢åº”ç”¨** (`.env.local`):
```bash
# APIé…ç½®
QWEN_API_KEY=sk-xxxxx
OPENAI_API_KEY=sk-xxxxx

# ç¤¾åŒºå¹³å°
COMMUNITY_API_URL=https://api.zishu.ai

# æœ¬åœ°æ¨¡å‹è·¯å¾„ (å¯é€‰)
LOCAL_MODEL_PATH=/path/to/models
```

**ç¤¾åŒºå¹³å°** (`.env`):
```bash
# æ•°æ®åº“
DATABASE_URL=postgresql://user:pass@localhost:5432/zishu
REDIS_URL=redis://localhost:6379/0
QDRANT_URL=http://localhost:6333

# JWT
JWT_SECRET=your-secret-key
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# å­˜å‚¨
STORAGE_BACKEND=s3  # s3 or local
S3_BUCKET=zishu-files
S3_ACCESS_KEY=xxx
S3_SECRET_KEY=xxx

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# é‚®ä»¶
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=noreply@zishu.ai
SMTP_PASSWORD=xxx

# ç›‘æ§
SENTRY_DSN=https://xxx@sentry.io/xxx
```

### 7.2 é…ç½®æ–‡ä»¶

**LLMé…ç½®** (`config/services/api_config.yml`):
```yaml
providers:
  qwen:
    api_key: ${QWEN_API_KEY}
    base_url: https://dashscope.aliyuncs.com/compatible-mode/v1
    model: qwen-max
    enabled: true
    priority: 8
    
  openai:
    api_key: ${OPENAI_API_KEY}
    base_url: https://api.openai.com/v1
    model: gpt-4-turbo-preview
    enabled: false
    priority: 9
```

---

## ğŸ“ˆ å…«ã€ç›‘æ§ä¸æ—¥å¿—

### 8.1 æ—¥å¿—ç³»ç»Ÿ

**æ—¥å¿—çº§åˆ«**:
- DEBUG: è¯¦ç»†è°ƒè¯•ä¿¡æ¯
- INFO: ä¸€èˆ¬ä¿¡æ¯
- WARNING: è­¦å‘Šä¿¡æ¯
- ERROR: é”™è¯¯ä¿¡æ¯
- CRITICAL: ä¸¥é‡é”™è¯¯

**æ—¥å¿—ä½ç½®**:
```
æ¡Œé¢åº”ç”¨: ~/.zishu/logs/app.log
ç¤¾åŒºå¹³å°: /var/log/zishu/api.log
```

### 8.2 æ€§èƒ½ç›‘æ§

**æŒ‡æ ‡æ”¶é›†**:
- APIå“åº”æ—¶é—´
- æ•°æ®åº“æŸ¥è¯¢æ—¶é—´
- ç¼“å­˜å‘½ä¸­ç‡
- é”™è¯¯ç‡
- è¯·æ±‚é‡ (QPS)

**ç›‘æ§å·¥å…·**:
- Prometheus + Grafana (æ¨è)
- Sentry (é”™è¯¯è¿½è¸ª)
- ELK Stack (æ—¥å¿—èšåˆ)

---

## ğŸ” ä¹ã€å®‰å…¨æœºåˆ¶

### 9.1 æ¡Œé¢åº”ç”¨å®‰å…¨

1. **æ²™ç®±éš”ç¦»**: é€‚é…å™¨åœ¨å—é™ç¯å¢ƒä¸­è¿è¡Œ
2. **æƒé™ç³»ç»Ÿ**: ç»†ç²’åº¦æƒé™æ§åˆ¶
3. **ä»£ç ç­¾å**: éªŒè¯é€‚é…å™¨æ¥æº
4. **åŠ å¯†å­˜å‚¨**: æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨

### 9.2 ç¤¾åŒºå¹³å°å®‰å…¨

1. **JWTè®¤è¯**: æ— çŠ¶æ€èº«ä»½éªŒè¯
2. **HTTPS**: å…¨ç«™HTTPSåŠ å¯†
3. **SQLæ³¨å…¥é˜²æŠ¤**: ORM + å‚æ•°åŒ–æŸ¥è¯¢
4. **XSSé˜²æŠ¤**: è¾“å…¥éªŒè¯ + è¾“å‡ºè½¬ä¹‰
5. **CSRFé˜²æŠ¤**: TokenéªŒè¯
6. **é€Ÿç‡é™åˆ¶**: é˜²æ­¢æš´åŠ›æ”»å‡»
7. **æ–‡ä»¶æ‰«æ**: ä¸Šä¼ æ–‡ä»¶ç—…æ¯’æ‰«æ

---

## ğŸ“š åã€å¼€å‘è§„èŒƒ

### 10.1 ä»£ç è§„èŒƒ

**Python**:
- PEP 8
- Black formatter
- Type hints
- Docstrings

**TypeScript**:
- ESLint + Prettier
- Strict mode
- JSDocæ³¨é‡Š

**Rust**:
- rustfmt
- clippyæ£€æŸ¥

### 10.2 Gitå·¥ä½œæµ

**åˆ†æ”¯ç­–ç•¥**:
```
main         - ç”Ÿäº§ç¯å¢ƒ
develop      - å¼€å‘ç¯å¢ƒ
feature/*    - åŠŸèƒ½åˆ†æ”¯
hotfix/*     - ç´§æ€¥ä¿®å¤
release/*    - å‘å¸ƒåˆ†æ”¯
```

**æäº¤è§„èŒƒ** (Conventional Commits):
```
feat: æ–°åŠŸèƒ½
fix: Bugä¿®å¤
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·
```

---

## ğŸ¯ åä¸€ã€å¼€å‘è·¯çº¿å›¾

### âœ… å·²å®Œæˆ
- [x] æ¡Œé¢åº”ç”¨åŸºç¡€æ¶æ„
- [x] Pythonæ ¸å¿ƒåº“
- [x] é€‚é…å™¨ç³»ç»Ÿ
- [x] æƒé™ç®¡ç†
- [x] æ€§èƒ½ç›‘æ§
- [x] å·¥ä½œæµç³»ç»Ÿ
- [x] ç¤¾åŒºå¹³å°å‰ç«¯åŸºç¡€
- [x] ç¤¾åŒºå¹³å°åç«¯åŸºç¡€

### ğŸš§ è¿›è¡Œä¸­
- [ ] é€‚é…å™¨å¸‚åœºå®Œå–„
- [ ] åœ¨çº¿æ‰“åŒ…æœåŠ¡
- [ ] Live2Dé›†æˆä¼˜åŒ–
- [ ] è¯­éŸ³äº¤äº’åŠŸèƒ½

### ğŸ“‹ è®¡åˆ’ä¸­
- [ ] ç§»åŠ¨ç«¯æ”¯æŒ (React Native)
- [ ] æ’ä»¶å¼€å‘è€…å·¥å…·
- [ ] æœ¬åœ°æ¨¡å‹å¾®è°ƒå·¥å…·
- [ ] ä¼ä¸šç‰ˆåŠŸèƒ½

---

## ğŸ“ åäºŒã€æŠ€æœ¯æ”¯æŒ

### æ–‡æ¡£
- **æ¶æ„è®¾è®¡**: `docs/ARCHITECTURE.md`
- **APIæ–‡æ¡£**: `docs/API.md`
- **éƒ¨ç½²æŒ‡å—**: `DEPLOYMENT.md`
- **è´¡çŒ®æŒ‡å—**: `CONTRIBUTING.md`

### è”ç³»æ–¹å¼
- **GitHub Issues**: https://github.com/yourusername/zishu-sensei/issues
- **Discordç¤¾åŒº**: https://discord.gg/zishu
- **é‚®ç®±**: support@zishu.ai

---

## ğŸ“ é™„å½•

### A. æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| **é€‚é…å™¨** | æ‰©å±•æ¡Œé¢åº”ç”¨åŠŸèƒ½çš„æ’ä»¶ |
| **å·¥ä½œæµ** | è‡ªåŠ¨åŒ–ä»»åŠ¡åºåˆ— |
| **æƒé™** | é€‚é…å™¨è®¿é—®ç³»ç»Ÿèµ„æºçš„è®¸å¯ |
| **æ‰“åŒ…** | ç”Ÿæˆè‡ªå®šä¹‰æ¡Œé¢åº”ç”¨å®‰è£…åŒ… |
| **Live2D** | 2Dè™šæ‹Ÿè§’è‰²åŠ¨ç”»æŠ€æœ¯ |
| **å‘é‡æœç´¢** | åŸºäºè¯­ä¹‰çš„æœç´¢æŠ€æœ¯ |
| **DDD** | é¢†åŸŸé©±åŠ¨è®¾è®¡ |
| **BFF** | Backend For Frontend |

### B. å¸¸è§é—®é¢˜

**Q: æ¡Œé¢åº”ç”¨å¦‚ä½•è°ƒç”¨äº‘ç«¯æ¨¡å‹?**
A: é€šè¿‡é…ç½®APIå¯†é’¥,ä½¿ç”¨`zishu/llm/`æ¨¡å—è°ƒç”¨äº‘ç«¯APIã€‚

**Q: å¦‚ä½•å¼€å‘è‡ªå·±çš„é€‚é…å™¨?**
A: ç»§æ‰¿`BaseAdapter`ç±»,å®ç°`execute()`æ–¹æ³•,å‚è€ƒç°æœ‰é€‚é…å™¨ã€‚

**Q: ç¤¾åŒºå¹³å°æ”¯æŒå“ªäº›éƒ¨ç½²æ–¹å¼?**
A: Docker Compose (æ¨è)ã€Kubernetesã€æ‰‹åŠ¨éƒ¨ç½²ã€‚

**Q: å¦‚ä½•å¤‡ä»½æ•°æ®?**
A: å®šæœŸå¤‡ä»½PostgreSQLã€Redisã€æ–‡ä»¶å­˜å‚¨,å‚è€ƒ`scripts/backup.sh`ã€‚

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Zishu Team  
**æœ€åæ›´æ–°**: 2025-10-31  
**ç‰ˆæœ¬**: 1.0



# Services æœåŠ¡å±‚æµ‹è¯•å¥—ä»¶

## ğŸ“‹ æ¦‚è¿°

æœ¬ç›®å½•åŒ…å«äº†æ¡Œé¢åº”ç”¨æ‰€æœ‰æœåŠ¡å±‚çš„å•å…ƒæµ‹è¯•,ç¡®ä¿æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§å’Œå¥å£®æ€§ã€‚

## âœ… å·²å®Œæˆçš„æµ‹è¯•æ–‡ä»¶ (12ä¸ª)

### 1. é€‚é…å™¨æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `adapterService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/adapter.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 60+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… è·å–é€‚é…å™¨åˆ—è¡¨
  - âœ… å®‰è£…/å¸è½½é€‚é…å™¨
  - âœ… æ‰§è¡Œé€‚é…å™¨æ“ä½œ
  - âœ… é€‚é…å™¨é…ç½®ç®¡ç†
  - âœ… æœç´¢é€‚é…å™¨
  - âœ… è·å–é€‚é…å™¨è¯¦æƒ…å’ŒçŠ¶æ€
  - âœ… å·¥å…·æ–¹æ³•(æ ¼å¼åŒ–ã€éªŒè¯ç­‰)
  - âœ… é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
  - âœ… æ€§èƒ½æµ‹è¯•

### 2. é€‚é…å™¨ç®¡ç†æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `adapterManagementService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/adapterManagementService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 50+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… å·²å®‰è£…é€‚é…å™¨ç®¡ç†
  - âœ… ç‰ˆæœ¬ç®¡ç†
  - âœ… ä¾èµ–ç®¡ç†å’Œæ£€æŸ¥
  - âœ… æƒé™ç®¡ç†
  - âœ… çŠ¶æ€å’Œæ ¼å¼åŒ–å·¥å…·
  - âœ… é”™è¯¯å¤„ç†
  - âœ… é›†æˆåœºæ™¯æµ‹è¯•

### 3. åŠ å¯†æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `encryptionService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/encryptionService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 70+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… æ–‡æœ¬åŠ å¯†/è§£å¯†
  - âœ… å¯†é’¥ç®¡ç†(ç”Ÿæˆã€åŠ è½½ã€è½®æ¢ã€åˆ é™¤)
  - âœ… åŠ å¯†å­—æ®µå­˜å‚¨
  - âœ… æ•°æ®è„±æ•(APIå¯†é’¥ã€å¯†ç ã€é‚®ç®±ã€æ‰‹æœºç­‰)
  - âœ… å®¡è®¡æ—¥å¿—æŸ¥è¯¢å’Œç®¡ç†
  - âœ… è¾…åŠ©æ–¹æ³•(å¯†ç å¼ºåº¦éªŒè¯ã€å¯†é’¥è¿‡æœŸæ£€æŸ¥ç­‰)
  - âœ… é”™è¯¯å¤„ç†
  - âœ… é›†æˆæµ‹è¯•åœºæ™¯

### 4. èŠå¤©æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `chatService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/chat/index.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 55+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… å‘é€æ¶ˆæ¯(æ™®é€šã€æµå¼ã€å¸¦ä¸Šä¸‹æ–‡)
  - âœ… è·å–èŠå¤©å†å²
  - âœ… æ¸…ç©ºèŠå¤©å†å²
  - âœ… è®¾ç½®èŠå¤©æ¨¡å‹
  - âœ… ç”Ÿæˆä¼šè¯ID
  - âœ… ä¾¿æ·å‡½æ•°æµ‹è¯•
  - âœ… é›†æˆæµ‹è¯•åœºæ™¯
  - âœ… æ€§èƒ½æµ‹è¯•

### 5. æ¡Œé¢æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `desktopService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/desktopApi.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 35+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… APIåˆå§‹åŒ–
  - âœ… ç½‘ç»œè¿æ¥æ£€æŸ¥
  - âœ… ç³»ç»Ÿä¿¡æ¯è·å–
  - âœ… æ€§èƒ½æŒ‡æ ‡ç›‘æ§
  - âœ… é”™è¯¯æŠ¥å‘Š
  - âœ… è®¾ç½®åŒæ­¥
  - âœ… æ›´æ–°æ£€æŸ¥

### 6. APIæœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `apiService.test.ts`
- **è¦†ç›–æœåŠ¡**: APIåº•å±‚è¯·æ±‚åŠŸèƒ½
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 40+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… HTTPæ–¹æ³•(GETã€POSTã€PUTã€DELETE)
  - âœ… é”™è¯¯å¤„ç†(ç½‘ç»œé”™è¯¯ã€HTTPé”™è¯¯ã€è¶…æ—¶ã€è®¤è¯é”™è¯¯)
  - âœ… è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
  - âœ… é‡è¯•æœºåˆ¶
  - âœ… ç¼“å­˜åŠŸèƒ½
  - âœ… å¹¶å‘è¯·æ±‚
  - âœ… æŸ¥è¯¢å‚æ•°å¤„ç†
  - âœ… è¯·æ±‚å–æ¶ˆ

### 7. å¸‚åœºæœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `marketService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/marketService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 35+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… æœç´¢äº§å“(é«˜çº§æœç´¢)
  - âœ… è·å–äº§å“è¯¦æƒ…
  - âœ… ä¸‹è½½äº§å“
  - âœ… è·å–äº§å“è¯„è®º
  - âœ… è·å–å¸‚åœºåˆ†ç±»
  - âœ… æ£€æŸ¥äº§å“æ›´æ–°
  - âœ… è·å–ç‰¹è‰²äº§å“
  - âœ… å·¥å…·æ–¹æ³•

### 8. å†…å­˜ç®¡ç†æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `memoryService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/memoryService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 25+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… è·å–å†…å­˜ä½¿ç”¨æƒ…å†µ
  - âœ… å†…å­˜æ¸…ç†
  - âœ… å†…å­˜ç›‘æ§(å¯åŠ¨/åœæ­¢)
  - âœ… å†…å­˜ä¼˜åŒ–
  - âœ… å†…å­˜æ³„æ¼æ£€æµ‹

### 9. æ–‡ä»¶æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `fileService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/fileService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 30+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… æ–‡ä»¶è¯»å–(æ–‡æœ¬ã€äºŒè¿›åˆ¶)
  - âœ… æ–‡ä»¶å†™å…¥
  - âœ… æ–‡ä»¶åˆ é™¤
  - âœ… æ–‡ä»¶åˆ—è¡¨
  - âœ… æ–‡ä»¶ä¸Šä¼ 
  - âœ… æ–‡ä»¶ä¸‹è½½
  - âœ… æ–‡ä»¶ä¿¡æ¯è·å–

### 10. é”™è¯¯ç›‘æ§æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `errorMonitoringService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/errorMonitoringService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 30+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… é”™è¯¯æ•è·å’Œè®°å½•
  - âœ… é”™è¯¯æŸ¥è¯¢å’Œè¿‡æ»¤
  - âœ… é”™è¯¯ç»Ÿè®¡
  - âœ… é”™è¯¯æŠ¥å‘Šç”Ÿæˆ
  - âœ… é”™è¯¯æ¸…ç†
  - âœ… é”™è¯¯é€šçŸ¥é…ç½®

### 11. æ—¥å¿—æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `loggingService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/loggingService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 35+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… æ—¥å¿—è®°å½•(infoã€errorã€warningã€debug)
  - âœ… æ—¥å¿—æŸ¥è¯¢å’Œè¿‡æ»¤
  - âœ… æ—¥å¿—å¯¼å‡º(å¤šç§æ ¼å¼)
  - âœ… æ—¥å¿—æ¸…ç†
  - âœ… æ—¥å¿—ç»Ÿè®¡
  - âœ… æ—¥å¿—é…ç½®

### 12. ä¸»é¢˜æœåŠ¡æµ‹è¯•
- **æ–‡ä»¶**: `themeService.test.ts`
- **è¦†ç›–æœåŠ¡**: `src/services/themeService.ts`
- **æµ‹è¯•ç”¨ä¾‹æ•°**: 35+
- **ä¸»è¦æµ‹è¯•å†…å®¹**:
  - âœ… è·å–ä¸»é¢˜(å½“å‰ã€æ‰€æœ‰å¯ç”¨)
  - âœ… åˆ‡æ¢ä¸»é¢˜(åŒ…æ‹¬è‡ªåŠ¨ä¸»é¢˜)
  - âœ… è‡ªå®šä¹‰ä¸»é¢˜(åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤)
  - âœ… ä¸»é¢˜å¯¼å…¥å¯¼å‡º
  - âœ… ä¸»é¢˜é¢„è§ˆ
  - âœ… ä¸»é¢˜é…ç½®
  - âœ… é¢œè‰²å·¥å…·(éªŒè¯ã€è½¬æ¢ã€é…è‰²æ–¹æ¡ˆç”Ÿæˆ)

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡ç»Ÿè®¡

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç”¨ä¾‹æ•° | è¦†ç›–åŠŸèƒ½ | çŠ¶æ€ |
|---------|----------|---------|------|
| adapterService.test.ts | 60+ | é€‚é…å™¨æ ¸å¿ƒåŠŸèƒ½ | âœ… å®Œæˆ |
| adapterManagementService.test.ts | 50+ | é€‚é…å™¨ç®¡ç† | âœ… å®Œæˆ |
| encryptionService.test.ts | 70+ | åŠ å¯†å’Œå®‰å…¨ | âœ… å®Œæˆ |
| chatService.test.ts | 55+ | èŠå¤©åŠŸèƒ½ | âœ… å®Œæˆ |
| desktopService.test.ts | 35+ | æ¡Œé¢æ“ä½œ | âœ… å®Œæˆ |
| apiService.test.ts | 40+ | APIè¯·æ±‚ | âœ… å®Œæˆ |
| marketService.test.ts | 35+ | å¸‚åœºå’Œå•†åº— | âœ… å®Œæˆ |
| memoryService.test.ts | 25+ | å†…å­˜ç®¡ç† | âœ… å®Œæˆ |
| fileService.test.ts | 30+ | æ–‡ä»¶æ“ä½œ | âœ… å®Œæˆ |
| errorMonitoringService.test.ts | 30+ | é”™è¯¯ç›‘æ§ | âœ… å®Œæˆ |
| loggingService.test.ts | 35+ | æ—¥å¿—ç®¡ç† | âœ… å®Œæˆ |
| themeService.test.ts | 35+ | ä¸»é¢˜ç®¡ç† | âœ… å®Œæˆ |
| **æ€»è®¡** | **500+** | **12ä¸ªæœåŠ¡** | **âœ… 100%** |

## ğŸ¯ æµ‹è¯•ç‰¹ç‚¹

### å…¨é¢æ€§
- âœ… è¦†ç›–æ‰€æœ‰æ ¸å¿ƒæœåŠ¡å±‚
- âœ… åŒ…å«æ­£å¸¸æµç¨‹å’Œå¼‚å¸¸æƒ…å†µ
- âœ… æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†
- âœ… åŒ…å«æ€§èƒ½æµ‹è¯•å’Œé›†æˆæµ‹è¯•

### å¥å£®æ€§
- âœ… å®Œæ•´çš„Mocké…ç½®
- âœ… è¯¦ç»†çš„æµ‹è¯•ç”¨ä¾‹æè¿°
- âœ… é”™è¯¯å¤„ç†æµ‹è¯•
- âœ… å¹¶å‘å’Œæ€§èƒ½æµ‹è¯•
- âœ… è¾¹ç•Œæƒ…å†µè¦†ç›–

### å¯ç»´æŠ¤æ€§
- âœ… æ¸…æ™°çš„æµ‹è¯•ç»“æ„
- âœ… è¾…åŠ©å‡½æ•°æå–
- âœ… ç»Ÿä¸€çš„æµ‹è¯•é£æ ¼
- âœ… å®Œå–„çš„æ³¨é‡Šè¯´æ˜
- âœ… æ˜“äºæ‰©å±•

## ğŸš€ è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æœåŠ¡æµ‹è¯•
```bash
npm test tests/unit/services
```

### è¿è¡Œç‰¹å®šæœåŠ¡æµ‹è¯•
```bash
npm test tests/unit/services/adapterService.test.ts
npm test tests/unit/services/encryptionService.test.ts
```

### è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
```bash
npm run test:coverage -- tests/unit/services
```

### ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
```bash
npm test tests/unit/services -- --watch
```

## ğŸ“ æµ‹è¯•ç¼–å†™è§„èŒƒ

### æµ‹è¯•ç»“æ„
```typescript
describe('ServiceName', () => {
  beforeEach(() => {
    // æµ‹è¯•å‰ç½®è®¾ç½®
  });

  afterEach(() => {
    // æµ‹è¯•æ¸…ç†
  });

  describe('Feature Group', () => {
    it('åº”è¯¥æ­£ç¡®å¤„ç†æ­£å¸¸æƒ…å†µ', async () => {
      // Arrange
      const input = ...;
      
      // Act
      const result = await service.method(input);
      
      // Assert
      expect(result).toBe(expected);
    });

    it('åº”è¯¥å¤„ç†é”™è¯¯æƒ…å†µ', async () => {
      // ...
    });
  });
});
```

### Mockä½¿ç”¨
```typescript
import { vi } from 'vitest';
import { invoke } from '@tauri-apps/api/core';

vi.mock('@tauri-apps/api/core', () => ({
  invoke: vi.fn(),
}));

// åœ¨æµ‹è¯•ä¸­
mockInvoke.mockResolvedValue({ success: true, data: ... });
```

### æ–­è¨€é£æ ¼
```typescript
// ä½¿ç”¨è¯­ä¹‰åŒ–çš„æ–­è¨€
expect(result).toBe(expected);
expect(result).toEqual(expected);
expect(result).toBeTruthy();
expect(array).toHaveLength(3);
expect(fn).toHaveBeenCalledWith(arg);
```

## ğŸ”§ Mockå·¥å‚å‡½æ•°

æ‰€æœ‰æµ‹è¯•éƒ½ä½¿ç”¨ç»Ÿä¸€çš„Mockå·¥å‚å‡½æ•°,ä½äº `tests/mocks/factories.ts`:

```typescript
import {
  createMockAdapter,
  createMockAdapterMetadata,
  createMockApiResponse,
  createMockErrorResponse,
} from '../../mocks/factories';
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•å®æ–½è®¡åˆ’](../docs/TEST_IMPLEMENTATION_PLAN.md)
- [æµ‹è¯•å·¥å…·å‡½æ•°](../../utils/test-utils.tsx)
- [Mocké…ç½®](../../mocks/README.md)
- [Vitestæ–‡æ¡£](https://vitest.dev/)

## ğŸ‰ æ€»ç»“

æœ¬æµ‹è¯•å¥—ä»¶åŒ…å«äº†**12ä¸ªæœåŠ¡æµ‹è¯•æ–‡ä»¶**,å…±è®¡**500+ä¸ªæµ‹è¯•ç”¨ä¾‹**,å…¨é¢è¦†ç›–äº†æ¡Œé¢åº”ç”¨çš„æ ¸å¿ƒæœåŠ¡å±‚åŠŸèƒ½ã€‚æ‰€æœ‰æµ‹è¯•éƒ½éµå¾ªæœ€ä½³å®è·µ,ç¡®ä¿ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ã€‚

**æµ‹è¯•å®Œæˆåº¦**: 100% âœ…  
**é¢„è®¡è¦†ç›–ç‡**: 85%+  
**æµ‹è¯•ç”¨ä¾‹æ€»æ•°**: 500+  
**æœåŠ¡æ•°é‡**: 12ä¸ª

---

**åˆ›å»ºæ—¥æœŸ**: 2025-10-20  
**æœ€åæ›´æ–°**: 2025-10-20  
**ç»´æŠ¤è€…**: Zishu Team


/* 消息项组件样式 */

/* ==================== 消息项容器 ==================== */

.messageItem {
    @apply relative mb-4 transition-all duration-200;
}

.messageItem:last-child {
    @apply mb-0;
}

.messageItemLast {
    @apply mb-6;
}

.messageItemCompact {
    @apply mb-2;
}

.messageInner {
    @apply relative flex flex-col gap-2;
}

/* ==================== 消息类型样式 ==================== */

.messageItemUser .messageInner {
    @apply items-end;
}

.messageItemAssistant .messageInner {
    @apply items-start;
}

.messageItemSystem {
    @apply opacity-75;
}

.messageItemSystem .messageInner {
    @apply items-center;
}

/* 置顶消息 */
.messageItemPinned {
    @apply bg-blue-50/50 dark:bg-blue-900/10 rounded-lg p-2 -mx-2;
    border-left: 3px solid theme('colors.blue.500');
}

/* 收藏消息 */
.messageItemStarred {
    @apply bg-yellow-50/30 dark:bg-yellow-900/10;
}

/* 错误消息 */
.messageItemError {
    @apply bg-red-50/30 dark:bg-red-900/10;
}

/* 流式消息动画 */
.messageItemStreaming .messageBody {
    animation: pulse-glow 2s ease-in-out infinite;
}

@keyframes pulse-glow {
    0%,
    100% {
        box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.2);
    }
    50% {
        box-shadow: 0 0 10px 2px rgba(59, 130, 246, 0.3);
    }
}

/* ==================== 消息头部 ==================== */

.messageHeader {
    @apply flex items-center gap-2 mb-1;
}

/* 头像 */
.avatar {
    @apply flex items-center justify-center w-8 h-8 rounded-full flex-shrink-0;
    @apply transition-transform duration-200;
}

.avatar:hover {
    @apply scale-110;
}

.avatarUser {
    @apply bg-blue-500 text-white;
}

.avatarAssistant {
    @apply bg-purple-500 text-white;
}

.avatarSystem {
    @apply bg-gray-400 text-white;
}

/* 头部信息 */
.headerInfo {
    @apply flex items-center gap-2 flex-1 min-w-0;
}

.roleName {
    @apply text-sm font-semibold text-gray-900 dark:text-gray-100;
}

.timestamp {
    @apply text-xs text-gray-500 dark:text-gray-400;
}

.editedTag {
    @apply text-xs text-gray-400 dark:text-gray-500 italic;
}

/* 状态标签 */
.statusBadge {
    @apply flex items-center gap-1.5 px-2 py-0.5 rounded-full;
    @apply bg-blue-100 text-blue-700 text-xs;
    @apply dark:bg-blue-900/30 dark:text-blue-300;
}

.loadingDots {
    @apply flex gap-1;
}

.loadingDots span {
    @apply w-1 h-1 bg-current rounded-full;
    animation: loading-dot 1.4s infinite ease-in-out;
}

.loadingDots span:nth-child(1) {
    animation-delay: -0.32s;
}

.loadingDots span:nth-child(2) {
    animation-delay: -0.16s;
}

@keyframes loading-dot {
    0%,
    80%,
    100% {
        transform: scale(0.6);
        opacity: 0.3;
    }
    40% {
        transform: scale(1);
        opacity: 1;
    }
}

/* 标记图标 */
.badges {
    @apply flex items-center gap-1;
}

.pinnedIcon {
    @apply text-blue-500;
}

.starredIcon {
    @apply text-yellow-500;
}

/* ==================== 消息主体 ==================== */

.messageBody {
    @apply relative max-w-[85%] rounded-lg px-4 py-3;
    @apply transition-all duration-200;
    word-wrap: break-word;
    word-break: break-word;
}

.messageItemUser .messageBody {
    @apply bg-blue-600 text-white;
    @apply shadow-sm;
}

.messageItemAssistant .messageBody {
    @apply bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100;
    @apply border border-gray-200 dark:border-gray-700;
    @apply shadow-sm;
}

.messageItemSystem .messageBody {
    @apply bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300;
    @apply max-w-full text-center text-sm;
}

.messageItemError .messageBody {
    @apply bg-red-50 dark:bg-red-900/20 text-red-900 dark:text-red-200;
    @apply border border-red-200 dark:border-red-800;
}

/* Hover 效果 */
.messageItem:hover .messageBody {
    @apply shadow-md;
}

/* ==================== 消息内容 ==================== */

.messageContent {
    @apply text-sm leading-relaxed;
}

.messageContent :global(strong) {
    @apply font-semibold;
}

.messageContent :global(em) {
    @apply italic;
}

.messageContent :global(code) {
    @apply px-1.5 py-0.5 rounded bg-black/10 dark:bg-white/10;
    @apply text-xs font-mono;
}

.messageContent :global(a) {
    @apply underline hover:no-underline;
}

.messageContent :global(pre) {
    @apply mt-2 p-3 rounded bg-black/5 dark:bg-white/5;
    @apply overflow-x-auto;
}

.messageContent :global(pre code) {
    @apply bg-transparent px-0 py-0;
}

/* 折叠内容 */
.collapsedContent {
    @apply flex items-center justify-center gap-2;
    @apply text-sm text-gray-500 dark:text-gray-400 cursor-pointer;
    @apply hover:text-gray-700 dark:hover:text-gray-300;
}

/* 错误内容 */
.errorContent {
    @apply flex items-start gap-2 text-sm;
}

.errorDetails {
    @apply mt-2 text-xs;
}

.errorDetails summary {
    @apply cursor-pointer hover:underline;
}

.errorDetails pre {
    @apply mt-1 p-2 bg-black/5 dark:bg-white/5 rounded overflow-x-auto;
}

/* 代码块 */
.codeBlock {
    @apply mt-2 rounded-lg overflow-hidden;
    @apply bg-gray-900 text-gray-100;
}

.codeHeader {
    @apply flex items-center justify-between px-3 py-2;
    @apply bg-gray-800 text-gray-300 text-xs;
}

.codeBlock pre {
    @apply p-3 m-0 overflow-x-auto;
    @apply bg-transparent;
}

.codeBlock code {
    @apply font-mono text-sm;
}

.copyButton {
    @apply p-1 rounded hover:bg-gray-700 transition-colors;
}

/* ==================== 编辑模式 ==================== */

.editContainer {
    @apply space-y-2 w-full;
}

.editTextarea {
    @apply w-full px-3 py-2 rounded border border-gray-300 dark:border-gray-600;
    @apply bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100;
    @apply focus:ring-2 focus:ring-blue-500 focus:border-transparent;
    @apply resize-y min-h-[80px];
}

.editActions {
    @apply flex items-center justify-end gap-2;
}

.editButton {
    @apply px-3 py-1.5 rounded text-sm font-medium;
    @apply transition-colors duration-200;
}

.editButtonCancel {
    @apply bg-gray-200 text-gray-700 hover:bg-gray-300;
    @apply dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600;
}

.editButtonSave {
    @apply bg-blue-600 text-white hover:bg-blue-700;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
}

/* ==================== 底部信息 ==================== */

.messageFooter {
    @apply flex items-center gap-3 mt-2 pt-2;
    @apply border-t border-current/10;
    @apply text-xs opacity-60;
}

.footerItem {
    @apply flex items-center gap-1;
}

/* ==================== 操作按钮 ==================== */

.messageActions {
    @apply absolute right-0 top-0 flex items-center gap-1;
    @apply opacity-0 transition-opacity duration-200;
}

.messageItem:hover .messageActions {
    @apply opacity-100;
}

.messageItemUser .messageActions {
    @apply right-auto left-0;
}

.actionButton {
    @apply p-1.5 rounded hover:bg-black/10 dark:hover:bg-white/10;
    @apply transition-colors duration-150;
    @apply text-gray-600 dark:text-gray-400;
    @apply hover:text-gray-900 dark:hover:text-gray-100;
}

.actionButton:active {
    @apply scale-95;
}

/* ==================== 下拉菜单 ==================== */

.menuContainer {
    @apply relative;
}

.menuDropdown {
    @apply absolute top-full right-0 mt-1 z-10;
    @apply min-w-[160px] py-1 rounded-lg shadow-lg;
    @apply bg-white dark:bg-gray-800;
    @apply border border-gray-200 dark:border-gray-700;
}

.menuDropdownRight {
    @apply right-auto left-0;
}

.menuItem {
    @apply flex items-center gap-2 w-full px-3 py-2;
    @apply text-sm text-gray-700 dark:text-gray-300;
    @apply hover:bg-gray-100 dark:hover:bg-gray-700;
    @apply transition-colors duration-150;
}

.menuItem:active {
    @apply bg-gray-200 dark:bg-gray-600;
}

.menuItemDanger {
    @apply text-red-600 dark:text-red-400;
    @apply hover:bg-red-50 dark:hover:bg-red-900/20;
}

.menuDivider {
    @apply my-1 border-t border-gray-200 dark:border-gray-700;
}

/* ==================== 响应式设计 ==================== */

@media (max-width: 640px) {
    .messageBody {
        @apply max-w-[90%];
    }

    .messageActions {
        @apply opacity-100;
    }

    .actionButton {
        @apply p-1;
    }

    .menuDropdown {
        @apply min-w-[140px];
    }
}

/* ==================== 无障碍支持 ==================== */

@media (prefers-reduced-motion: reduce) {
    .messageItem,
    .avatar,
    .actionButton,
    .editButton {
        @apply transition-none;
    }

    .messageItemStreaming .messageBody {
        animation: none;
    }

    .loadingDots span {
        animation: none;
    }
}

/* 高对比度模式 */
@media (prefers-contrast: high) {
    .messageBody {
        @apply border-2;
    }

    .actionButton {
        @apply border border-current;
    }
}

/* ==================== 打印样式 ==================== */

@media print {
    .messageActions,
    .editActions {
        @apply hidden;
    }

    .messageBody {
        @apply shadow-none border;
    }

    .messageItem {
        @apply break-inside-avoid;
    }
}

